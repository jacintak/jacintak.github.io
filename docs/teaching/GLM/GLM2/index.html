<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jacinta Kong">

  
  
  
    
  
  <meta name="description" content="Overall lecture aimsIdentify the structure of general linear modelsDescribe how linear models are parametrizedUnderstand how to use linear modelsUnderstand how to interpret and evaluate linear modelsRecommended reading:Chapter 5.5 Getting Started with R
By the end of this lecture you should:Understand the parameters of a linear model with multiple predictor variablesParametrise and use a multiple regression model to predict values from the R output of a linear regressionInterpret and complete ANOVA tables with multiple predictor variablesUnderstand an interaction between two predictor variablesConduct a multiple regression in R with 2 continuous or categorical predictor variables or a combinationPreviously, we parametrised slopes and intercepts of simple linear modelsWith one continuous response variable and one continuous predictor variable">

  
  <link rel="alternate" hreflang="en-us" href="https://jacintak.github.io/teaching/GLM/GLM2/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jacintak.github.io/teaching/GLM/GLM2/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jacintakong">
  <meta property="twitter:creator" content="@jacintakong">
  
  <meta property="og:site_name" content="Jacinta&#39;s Website">
  <meta property="og:url" content="https://jacintak.github.io/teaching/GLM/GLM2/">
  <meta property="og:title" content="Multiple regression | Jacinta&#39;s Website">
  <meta property="og:description" content="Overall lecture aimsIdentify the structure of general linear modelsDescribe how linear models are parametrizedUnderstand how to use linear modelsUnderstand how to interpret and evaluate linear modelsRecommended reading:Chapter 5.5 Getting Started with R
By the end of this lecture you should:Understand the parameters of a linear model with multiple predictor variablesParametrise and use a multiple regression model to predict values from the R output of a linear regressionInterpret and complete ANOVA tables with multiple predictor variablesUnderstand an interaction between two predictor variablesConduct a multiple regression in R with 2 continuous or categorical predictor variables or a combinationPreviously, we parametrised slopes and intercepts of simple linear modelsWith one continuous response variable and one continuous predictor variable"><meta property="og:image" content="https://jacintak.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://jacintak.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
    <meta property="article:modified_time" content="2020-12-14T18:01:51&#43;00:00">
  

  



  


  


  





  <title>Multiple regression | Jacinta&#39;s Website</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">Jacinta&#39;s Website</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/CV/"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/teaching/GLM/">Overview</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/teaching/GLM/GLM1/">Simple regression</a>
      </li>
      
      <li class="active">
        <a href="/teaching/GLM/GLM2/">Multiple regression</a>
      </li>
      
      <li >
        <a href="/teaching/GLM/GLM3/">Generalised linear models</a>
      </li>
      
      <li >
        <a href="/teaching/GLM/GLM4/">Assumptions</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Multiple regression</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<hr />
<div id="overall-lecture-aims" class="section level1">
<h1>Overall lecture aims</h1>
<ul>
<li>Identify the structure of general linear models</li>
<li>Describe how linear models are parametrized</li>
<li>Understand how to use linear models</li>
<li>Understand how to interpret and evaluate linear models</li>
</ul>
<p>Recommended reading:
Chapter 5.5 Getting Started with R</p>
<div id="by-the-end-of-this-lecture-you-should" class="section level2">
<h2>By the end of this lecture you should:</h2>
<ul>
<li>Understand the parameters of a linear model with multiple predictor variables</li>
<li>Parametrise and use a multiple regression model to predict values from the R output of a linear regression</li>
<li>Interpret and complete ANOVA tables with multiple predictor variables</li>
<li>Understand an interaction between two predictor variables</li>
<li>Conduct a multiple regression in R with 2 continuous or categorical predictor variables or a combination</li>
</ul>
<hr />
</div>
</div>
<div id="previously-we-parametrised-slopes-and-intercepts-of-simple-linear-models" class="section level1">
<h1>Previously, we parametrised slopes and intercepts of simple linear models</h1>
<p>With one continuous response variable and one continuous predictor variable</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X\]</span></p>
<p>where the parameters <span class="math inline">\(\beta_0\)</span> = intercept and <span class="math inline">\(\beta_1\)</span> = slope</p>
<p><img src="/teaching/GLM/GLM2_files/figure-html/general-lm-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>So far these parameters have been <em>fixed</em>…</p>
</div>
<div id="parameters-of-a-linear-model-can-be-random-or-fixed" class="section level1">
<h1>Parameters of a linear model can be <strong>random</strong> or <strong>fixed</strong></h1>
<ul>
<li>Important to consider when designing experiments – you decide!</li>
<li>Changes the hypotheses &amp; interpretation of results</li>
<li>Fixed:
Constant across all groupings (how observations are related – e.g. populations of individuals)</li>
<li>Random:
Vary across groupings, or represent a random sample from a larger population</li>
</ul>
<div id="fixed-slopes-linear-model" class="section level2">
<h2>Fixed slopes linear model</h2>
<ul>
<li>All groups (Frequency of exercise in this example) have the same slope</li>
<li>Response of groups to predictor variable x is consistent across groups</li>
<li>Cannot extrapolate beyond groups</li>
<li><em>Thus can only draw conclusions for these groups</em></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:fixed-slopes-model"></span>
<img src="/teaching/GLM/GLM2_files/figure-html/fixed-slopes-model-1.png" alt="Height of students of various frequencies of exercise and hand width" width="300" />
<p class="caption">
Figure 1: Height of students of various frequencies of exercise and hand width
</p>
</div>
</div>
<div id="random-slopes-linear-model" class="section level2">
<h2>Random slopes linear model</h2>
<ul>
<li>All groups have different slopes</li>
<li>Response of groups to predictor variable x varies among groups</li>
<li>Can extrapolate beyond observed groups</li>
<li>Identity of group is not the main question</li>
<li><em>Thus can generalise to other groups outside study</em></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:random-slopes-model"></span>
<img src="/teaching/GLM/GLM2_files/figure-html/random-slopes-model-1.png" alt="Each group has a different slope" width="300" />
<p class="caption">
Figure 2: Each group has a different slope
</p>
</div>
</div>
<div id="distinguishing-between-fixed-or-random-is-important" class="section level2">
<h2>Distinguishing between Fixed or random is important</h2>
<blockquote>
<p>Changes the way Analysis of Variance (ANOVA) is calculated</p>
</blockquote>
<ul>
<li>Changes formula for Mean Sum of Squares</li>
<li>Changes numerator/denominator of F ratio</li>
<li>Thus changes interpretation</li>
<li>Called Type I (fixed), II (random) or III (mixed)</li>
</ul>
<hr />
</div>
</div>
<div id="t-tests-simple-linear-models-anova" class="section level1">
<h1>t-tests, simple linear models, ANOVA</h1>
<ul>
<li>Predictor variables can be categorical (called factors in R), like exercise in Figures <a href="#fig:fixed-slopes-model">1</a> &amp; <a href="#fig:random-slopes-model">2</a></li>
<li>Can have two or more sub-categories (called levels in R)
<ul>
<li>E.g. sex: male/female, level of drug: low/medium/high</li>
</ul></li>
</ul>
<p>Typically, the relationship between a continuous response variable &amp; categorical predictors is analysed using a special case of statistical models: One-way Analysis of Variance (ANOVA)</p>
<p>Confusingly, ANOVA can refer to how data are spread around a single mean (<em>variance</em>) and also a way of comparing means (via how similar their variances are) for experimental designs with a predictor variable with any number of levels.</p>
</div>
<div id="fixed-one-way-anova-with-2-or-more-levels" class="section level1">
<h1>Fixed one-way ANOVA with 2 or more levels</h1>
<ul>
<li>level = subsets within categories
<ul>
<li>e.g. male/female, low/medium/high</li>
</ul></li>
<li>We are testing means for each level</li>
<li>What is the null hypothesis?</li>
</ul>
<blockquote>
<p><span class="math inline">\(H_0:\)</span> All levels come from the same population (have the same mean)</p>
</blockquote>
<div id="pulse-rate-and-exercise" class="section level2">
<h2>Pulse rate and exercise</h2>
<p><img src="/teaching/GLM/GLM2_files/figure-html/pulse-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>We can do an ANOVA and get the following output:</p>
<pre><code>Analysis of Variance Table

Response: Pulse
           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
Exer        2   900.5  450.23  3.3783 0.03618 *
Residuals 189 25188.2  133.27                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<blockquote>
<p>Conclusions: We can reject the null hypothesis that there is no difference in mean pulse rate of students with different amount of exercise</p>
</blockquote>
<p>Report the degrees of freedom (df), the F ratio and the P value like
<span class="math display">\[F_{2,189} = 3.38, P = 0.036\]</span>
Where 2 is the df of the groups (<code>Exer</code>) and 189 is the df of the residual error (<code>Residuals</code>).</p>
</div>
</div>
<div id="the-anova-table" class="section level1">
<h1>The ANOVA table</h1>
<table style="width:100%;">
<colgroup>
<col width="56%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Source of variation</th>
<th align="center">SS</th>
<th align="center">df</th>
<th align="center">MS</th>
<th align="center">F</th>
<th>P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Variance among groups</td>
<td align="center">SSR</td>
<td align="center">number of levels - 1</td>
<td align="center"><span class="math inline">\(MSR = \frac{SSR}{df}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MSR}{MSE}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td align="center">Variance within group</td>
<td align="center">SSE</td>
<td align="center">number of observations - 2</td>
<td align="center"><span class="math inline">\(MSE = \frac{SSE}{df}\)</span></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td align="center">Total error</td>
<td align="center">SSY</td>
<td align="center">total number of observations - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
</tbody>
</table>
<div id="calculating-group-means" class="section level2">
<h2>Calculating group means</h2>
<p>Check <code>summary()</code> to see group means</p>
<pre><code>
Call:
lm(formula = Pulse ~ Exer, data = survey)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.188  -7.968  -0.188   7.812  32.032 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   71.968      1.184  60.763   &lt;2e-16 ***
ExerNone       4.796      3.040   1.578    0.116    
ExerSome       4.219      1.752   2.408    0.017 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 11.54 on 189 degrees of freedom
  (45 observations deleted due to missingness)
Multiple R-squared:  0.03452,   Adjusted R-squared:  0.0243 
F-statistic: 3.378 on 2 and 189 DF,  p-value: 0.03618</code></pre>
<ul>
<li>Groups are calculated in alphabetical order - Here “Frequent” group is calculated first</li>
<li><code>Estimate</code> column shows the <strong>difference in means</strong> - see below</li>
<li>P values test differences in <strong>pairs of means</strong> BUT should we be doing multiple comparisons? (no)</li>
</ul>
<p>Model coefficients:</p>
<pre><code>(Intercept)    ExerNone    ExerSome 
  71.968421    4.796285    4.219079 </code></pre>
<p>R-calculated means:</p>
<pre><code>    Freq     None     Some 
71.96842 76.76471 76.18750 </code></pre>
<p>Manually calculated means for “None” group:
71.9684211 + 4.7962848 = 76.7647059</p>
<p>Manually calculated means for “Some” group:
71.9684211 + 4.2190789 = 76.1875</p>
</div>
</div>
<div id="anova-and-hypothesis-testing" class="section level1">
<h1>ANOVA and hypothesis testing</h1>
<p><strong>Important to remember:</strong></p>
<ul>
<li>ANOVA is a test of means (analysis of variance about the mean)</li>
<li>F-ratio tells you that there is a difference in the means between pairs of groups but NOT which pairs are different</li>
<li>Need post-hoc tests like Tukey’s Honest Significant Differences (not covered in this lecture) to see <em>which pairs</em> are significantly different</li>
</ul>
<hr />
</div>
<div id="recap-time" class="section level1">
<h1>Recap time!</h1>
<p>Test your understanding so far by answering the questions below. Click <code>Code</code> to see the answer.</p>
<p>What is the significance of fixed and random variables for drawing conclusions?</p>
<pre class="r fold-hide"><code>It changes the inferred conclusion. In fixed models, the identities of the groupings are the main level of inference whereas in random models we consider the identity of the group to be randomly selected from a wider pool of candidates. Thus we can generalise our findings beyond our selected groups in random models but are limited to the groups we selected in fixed models. 

For example, if we counted the population of 5 towns in Ireland and analysed the data using a fixed model, then we could only state our conclusion for those 5 towns and cannot draw conclusions for the whole of Ireland.

With a random model, we consider those 5 towns to be representitive of the whole of Ireland, we are not interested in those 5 towns in particular, thus we can generalise our conclusions to the whole of Ireland. E.g. those 5 towns were randomly selected from all the candidate towns to survey.</code></pre>
<p>What is the function to conduct an Analysis of Variance in R?</p>
<pre class="r fold-hide"><code>Either summary(aov()) or anova(lm()) will do a Type I ANOVA. Type II and Type III models require additional packages.</code></pre>
<p>How many groups were in the categorical predictor variable in this one-way analysis of variance? <span class="math inline">\(F_{5,24} = 14.23, P &lt; 0.001\)</span></p>
<pre class="r fold-hide"><code>6 groups. The degree of freedom for group is 5 and this is calculated from the number of groups - 1. So 5 + 1 = 6.</code></pre>
<hr />
</div>
<div id="multiple-regression" class="section level1">
<h1>Multiple regression</h1>
<p>We can include more than 1 predictor variable in our models</p>
<blockquote>
<p>Multiple regression: Linear models with two or more predictor variables</p>
</blockquote>
<ul>
<li>Models the effect of multiple predictors on response</li>
<li>Two-way ANOVAs etc. are special cases of multiple regression</li>
<li>If 3 categorical predictors, then three-way ANOVA etc…</li>
<li>With more predictor variables, the model becomes complex
<ul>
<li>And potentially less informative/difficult to interpret</li>
<li>Remember the trade-off between generality &amp; complexity</li>
<li>Keep it simple</li>
</ul></li>
</ul>
<div id="height-and-hand-width" class="section level2">
<h2>Height and hand width</h2>
<p>Imagine we asked the class <em>is there a relationship between your height and the width of your hand?</em><br />
The linear model is:</p>
<p><span class="math display">\[ height  = \beta_0 + \beta_1 hand \space width + \varepsilon_i\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:hand-height"></span>
<img src="/teaching/GLM/GLM2_files/figure-html/hand-height-1.png" alt="The relationship between hand width and height of students" width="300" />
<p class="caption">
Figure 3: The relationship between hand width and height of students
</p>
</div>
<p>Good, but let’s ask is it also important to consider the sex of the student?</p>
<div class="figure" style="text-align: center"><span id="fig:hand-height-sex"></span>
<img src="/teaching/GLM/GLM2_files/figure-html/hand-height-sex-1.png" alt="The relationship between hand width and height of male (yellow) or female (purple) students" width="300" />
<p class="caption">
Figure 4: The relationship between hand width and height of male (yellow) or female (purple) students
</p>
</div>
<blockquote>
<p>Does including information about sex improve our ability to detect/understand patterns?</p>
</blockquote>
<p>The linear model now has two predictor variables and is written as:</p>
<p><span class="math display">\[ height  = \beta_{0_{sex}} + \beta_1 hand \space width + \varepsilon_i\]</span>
Notice that the intercept parameter (<span class="math inline">\(\beta_{0_{sex}}\)</span>) now specifies that it is dependent on the sex of the student.</p>
<p>Since Sex is a categorical predictor with 2 levels, this model now describes two lines - one for each level of the predictor (male/female)</p>
<div id="does-student-height-vary-with-hand-width-and-between-sexes" class="section level3">
<h3>Does student height vary with hand width and between sexes?</h3>
<ul>
<li>Continuous response</li>
<li>Categorical predictor</li>
<li>Continuous predictor (also called covariate)</li>
<li>Can be analysed using multiple linear models</li>
<li>Two types:
<ul>
<li>Additive model (<strong>Fixed slopes model</strong>)</li>
<li>Interactive model (<strong>Random slopes model</strong>)</li>
</ul></li>
</ul>
<p>Analysis of Covariance is a special case with unique assumptions (not considered here), else called a general linear model</p>
</div>
</div>
<div id="fixed-slopes-additive-model" class="section level2">
<h2>Fixed slopes (additive model)</h2>
<ul>
<li>No interaction term</li>
<li>Same slope</li>
<li>Intercept for each sex</li>
<li>in <code>R</code>: <code>lm(Y ~ A + B, data)</code> where A &amp; B are the two predictor variables</li>
</ul>
<blockquote>
<p>H0: There is no effect of A or B on the response variable
H1: There is an effect of A or B on the response variable</p>
</blockquote>
<div class="figure" style="text-align: center"><span id="fig:same-slope"></span>
<img src="/teaching/GLM/GLM2_files/figure-html/same-slope-1.png" alt="the lines are parallel to each other" width="300" />
<p class="caption">
Figure 5: the lines are parallel to each other
</p>
</div>
<pre><code>(Intercept)      Wr.Hnd     SexMale 
 137.686951    1.594446    9.489814 </code></pre>
<p>Parametrised slope for females:<br />
<em>Female height</em> = 137.687 + 1.594 <em>hand width</em></p>
<p>Parametrised slope for males:<br />
<em>Male height</em> = (137.687 + 9.49) + 1.594 <em>hand width</em></p>
<blockquote>
<p>Remember R shows the difference between parameter estimates so you need to extract the correct values</p>
</blockquote>
</div>
<div id="random-slopes-interactive-model" class="section level2">
<h2>Random slopes (interactive model)</h2>
<p>The random slopes model has in interaction term. In R this is coded <code>lm(Height ~ Wr.Hnd * Sex, survey)</code>.</p>
<p>The linear model is now:</p>
<p><span class="math display">\[ height  = \beta_{0_{sex}} + \beta_{1_{sex}} hand \space width + \varepsilon_i\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:random-slopes"></span>
<img src="/teaching/GLM/GLM2_files/figure-html/random-slopes-1.png" alt="The lines have different slopes and intercepts" width="300" />
<p class="caption">
Figure 6: The lines have different slopes and intercepts
</p>
</div>
<pre><code>   (Intercept)         Wr.Hnd        SexMale Wr.Hnd:SexMale 
   147.4497131      1.0385045     -7.1567184      0.9020249 </code></pre>
<p>To parametrise the model we now need to calculate different values for slopes. In the coefficient list, <code>Wr.Hnd:SexMale</code> is the <strong>difference in the value of the slope relative to the slope for female</strong> <code>Wr.Hnd</code>. Remember: female is alphabetically before male so R calculates the variances for females first, then males.</p>
<p>Parametrised slope for females:<br />
<em>Female height</em> = 147.45 + 1.039 <em>hand width</em></p>
<p>Parametrised slope for males:<br />
<em>Male height</em> = (147.45 -7.157) + (1.039 + 0.902) <em>hand width</em></p>
<blockquote>
<p>H0: There is no effect of A or B or their interaction on the response variable
H1: There is an effect of A or B or their interaction on the response variable</p>
</blockquote>
<hr />
</div>
<div id="the-multiple-regression-anova-table" class="section level2">
<h2>The multiple regression ANOVA table</h2>
<blockquote>
<p>Variance of predictors (SS) is partitioned out from total SS in order it is entered in to R</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Wr.Hnd</td>
<td align="right">1</td>
<td align="right">7298.70354</td>
<td align="right">7298.70354</td>
<td align="right">150.128633</td>
<td align="right">3.359137e-26</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="right">1</td>
<td align="right">2912.37262</td>
<td align="right">2912.37262</td>
<td align="right">59.905231</td>
<td align="right">4.604092e-13</td>
</tr>
<tr class="odd">
<td align="left">Wr.Hnd:Sex</td>
<td align="right">1</td>
<td align="right">90.06608</td>
<td align="right">90.06608</td>
<td align="right">1.852589</td>
<td align="right">1.749916e-01</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">203</td>
<td align="right">9869.11550</td>
<td align="right">48.61633</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="the-anova-table-for-2-predictors-and-their-interaction" class="section level2">
<h2>The ANOVA table for 2 predictors and their interaction</h2>
<table>
<thead>
<tr class="header">
<th align="center">Source of variation</th>
<th align="center">SS</th>
<th align="center">df</th>
<th align="center">MS</th>
<th align="center">F</th>
<th>P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Factor A</td>
<td align="center">SSR of A</td>
<td align="center">number of levels of A - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="even">
<td align="center">Factor B</td>
<td align="center">SSR of B</td>
<td align="center">number of levels of B - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td align="center">Factor A x B</td>
<td align="center">SSR of A &amp; B</td>
<td align="center">df of A x df of B</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="even">
<td align="center">Within error</td>
<td align="center">SSE</td>
<td align="center">levels of A x levels of B X (number of observations - 1)</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td align="center">Total error</td>
<td align="center">SSY</td>
<td align="center">(levels of A x levels of B X number of observations) - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="interpreting-the-anova-table" class="section level2">
<h2>Interpreting the ANOVA table</h2>
<blockquote>
<p>P(Interaction term) &gt; 0.05, thus the effect of hand width on
student height is not dependent of the sex of the student</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Wr.Hnd</td>
<td align="right">1</td>
<td align="right">7298.70354</td>
<td align="right">7298.70354</td>
<td align="right">150.128633</td>
<td align="right">3.359137e-26</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="right">1</td>
<td align="right">2912.37262</td>
<td align="right">2912.37262</td>
<td align="right">59.905231</td>
<td align="right">4.604092e-13</td>
</tr>
<tr class="odd">
<td align="left">Wr.Hnd:Sex</td>
<td align="right">1</td>
<td align="right">90.06608</td>
<td align="right">90.06608</td>
<td align="right">1.852589</td>
<td align="right">1.749916e-01</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">203</td>
<td align="right">9869.11550</td>
<td align="right">48.61633</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="the-interaction-term-ab" class="section level2">
<h2>The interaction term A:B</h2>
<ul>
<li>Measures the dependence of the level of one factor on the level of the other factors</li>
<li>If interaction term is not significant:
<ul>
<li>effect of one factor on other is additive (independent of each other)</li>
</ul></li>
<li>If significant:
<ul>
<li>indicates synergistic or antagonistic effects between factors</li>
<li>Should be main conclusion of analysis</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="the-fundamentals-of-linear-regression" class="section level1">
<h1>The fundamentals of Linear regression</h1>
<p>That’s the basics of linear regression!<br />
They are widely used in biological statistics so you’ll likely come across them when reading scientific studies.</p>
<p>The same concepts apply for any number or combination of predictor variables. Two, three, four predictor variables and so forth…it just becomes more complex to parameterise.</p>
<p>Remember, the aim is to quantify how much variation in the response variable is attributable to each predictor variable - minimise those residuals!</p>
<p>Common statistical analyses you should be able to do by applying the concepts in these lectures:
1 continuous response variable &amp;:</p>
<ul>
<li>1 continuous predictor variable - simple linear regression</li>
<li>2 continuous predictor variables (with/without their interaction) - multiple regression</li>
<li>1 categorical predictor variable - One-way ANOVA</li>
<li>1 continuous predictor variable &amp; 1 categorical predictor variable (with/without their interaction) - ANCOVA/multiple regression</li>
<li>2 categorical predictor variables (with/without their interaction) - Two-way ANOVA</li>
</ul>
<hr />
</div>
<div id="recap-time-1" class="section level1">
<h1>Recap time!</h1>
<p>Test your understanding so far by answering the questions below. Click <code>Code</code> to see the answer.</p>
<p>What is the difference between an additive and interactive linear model?</p>
<pre class="r fold-hide"><code>An additive model does not describe an interaction between the two predictor variables. An interactive model describes that the effect of one predictor variable on the response variable is dependent on the second predictor variable.</code></pre>
<p>What is the function to conduct an interactive multiple regression model in R?</p>
<pre class="r fold-hide"><code>lm(Y ~ A * B, data) where A &amp; B are the two predictor variables. * denotes the interaction.</code></pre>
<p>A multiple regression of crab shell width (response) with crab body depth (continuous predictor) for two species (categorical predictor: B or O) and their interaction had the following coefficients:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6942643</td>
</tr>
<tr class="even">
<td align="left">BD</td>
<td align="right">2.5449206</td>
</tr>
<tr class="odd">
<td align="left">spO</td>
<td align="right">-1.2531624</td>
</tr>
<tr class="even">
<td align="left">BD:spO</td>
<td align="right">-0.1756934</td>
</tr>
</tbody>
</table>
<p>What is the predicted shell length (mm) of a species O crab with a body depth of 15mm?</p>
<pre class="r fold-hide"><code>Answer: 36.97951 mm

Because B is alphabetically before O, the first parameter coefficients refer to species B. 
The intercept for species O is 2.6942643-1.2531624 = 1.441102
The slope for species O is  2.5449206-0.1756934 = 2.369227
Thus the whole model for species O is:
  shell length = 2.369227 * body depth + 1.441102

Using a value of 15 for body depth:
  shell length = 2.369227 * 15 + 1.441102
               = 36.97951 mm</code></pre>
</div>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/teaching/GLM/GLM1/" rel="next">Simple regression</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/teaching/GLM/GLM3/" rel="prev">Generalised linear models</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 14 Dec 2020</p>

          




          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
