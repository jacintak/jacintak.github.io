
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="GLM" class="section level1">
<h1>Generalised linear models</h1>
<hr />
<div id="overall-lecture-aims" class="section level2">
<h2>Overall lecture aims</h2>
<ul>
<li>Identify the structure of general linear models</li>
<li>Describe how linear models are parametrized</li>
<li>Understand how to use linear models</li>
<li>Understand how to interpret and evaluate linear models</li>
</ul>
<div id="by-the-end-of-this-lecture-you-should" class="section level3">
<h3>By the end of this lecture you should:</h3>
<ul>
<li>Conduct and interpret a generalised linear model in R</li>
</ul>
<hr />
</div>
</div>
<div id="some-data-are-never-normal" class="section level2">
<h2>Some data are never normal</h2>
<ul>
<li>Non-linear data - e.g. exponential growth of bacteria, human populations</li>
<li>Counts or proportions, number of cells in petri dish, proportion of animals that survive</li>
<li>Categorical data</li>
</ul>
<p>Simple linear regressions aren’t the most appropriate for these data and may give distorted results.<br />
<em>But</em> we can use linear regression to analyse these data if we relax our assumptions a bit…called “general linear models”</p>
<blockquote>
<p><em>General linear models</em>, or just linear models (LM), refer to linear regression of data following a normal probability distribution, fixed or random. If we do a linear regression on based on a non-normal probability distribution that’s called a <em>general<strong>ised</strong> linear model</em> (usually abbreviated to GLM).</p>
</blockquote>
<p>There are many types but we will briefly describe two common probability distributions:</p>
<ul>
<li>Binomial regression - for binomial data following a binomial distribution
<ul>
<li>yes/no</li>
<li>alive/dead</li>
</ul></li>
<li>Poisson regression - for count or contingency table data following a Poisson distribution</li>
</ul>
<p>In <code>R</code> GLMs are done using <code>glm(Y ~ X, data, family = &lt;insert here&gt;)</code>. <code>family</code> refers to the underlying probability distribution. Using <code>family = gaussian</code> is the same as <code>lm()</code> for a normal distribution. So:</p>
<ul>
<li><code>poisson</code> for a Poisson distribution</li>
<li><code>binomial</code> for a binomial distribution</li>
</ul>
<p>But the model outputs are interpreted differently to normal distributions because they <em>link</em> the relationship between the predictor and the response differently.</p>
<hr />
</div>
<div id="poisson-regression" class="section level2">
<h2>Poisson regression</h2>
<ul>
<li>Uses a log linear link function where the response variable (counts) is on a log scale</li>
<li>Interpretation is similar to lm with estimates for the intercept, slopes and differences in estimates among groups
<ul>
<li>Estimates are the <strong>log of the expected count</strong> as a function of the predictor variables</li>
<li>Cannot have negative or 0 values because log(0) does not work - must deal with them. How?</li>
</ul></li>
<li>Test overall effects of predictors by comparing models with different predictors representing null and alternative hypotheses</li>
<li>See later lectures about Chi-Squared tests (<span class="math inline">\(\chi^2\)</span>).</li>
</ul>
<div id="number-of-oystercatchers-wetland-birds-in-south-africa" class="section level3">
<h3>Number of Oystercatchers (wetland birds) in South Africa</h3>
<p>Data is <code>waders</code> from <code>MASS</code>. I have manipulated the data so it is suitable for analysis - code below.</p>
<pre class="r"><code># create data set of oystercatcher counts (column 1) and site labels
waders &lt;- data.frame(Oystercatcher = MASS::waders[,1],
                     site = letters[1:15])
# poisson regression
summary(glm(Oystercatcher + 1 ~ site, waders, family = poisson))</code></pre>
<pre><code>
Call:
glm(formula = Oystercatcher + 1 ~ site, family = poisson, data = waders)

Deviance Residuals: 
 [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.5649     0.2774   9.248  &lt; 2e-16 ***
siteb         2.0402     0.2948   6.920 4.51e-12 ***
sitec         2.7233     0.2863   9.512  &lt; 2e-16 ***
sited        -2.5649     1.0377  -2.472   0.0134 *  
sitee         1.7918     0.2996   5.981 2.22e-09 ***
sitef         0.4308     0.3563   1.209   0.2266    
siteg         4.3665     0.2791  15.645  &lt; 2e-16 ***
siteh         1.9124     0.2971   6.436 1.23e-10 ***
sitei         4.1058     0.2796  14.683  &lt; 2e-16 ***
sitej         1.8539     0.2983   6.215 5.12e-10 ***
sitek         3.5984     0.2811  12.800  &lt; 2e-16 ***
sitel         1.7918     0.2996   5.981 2.22e-09 ***
sitem         0.5705     0.3470   1.644   0.1001    
siten        -2.5649     1.0377  -2.472   0.0134 *  
siteo        -2.5649     1.0377  -2.472   0.0134 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5.3666e+03  on 14  degrees of freedom
Residual deviance: 1.6653e-14  on  0  degrees of freedom
AIC: 114.06

Number of Fisher Scoring iterations: 3</code></pre>
<p><strong>Question 1</strong> - Why did I add 1 to the variable Oystercatcher in the poisson regression?</p>
<p><strong>Question 2</strong> - What is the link function for a poisson regression?</p>
<p><strong>Question 3</strong> - What is the expected number of Oystercatchers at site k?</p>
<hr />
</div>
</div>
<div id="binomial-logistic-regression" class="section level2">
<h2>Binomial (logistic) regression</h2>
<ul>
<li>Uses a logit link function so the response variable is the <strong>log odds</strong></li>
<li>Estimates are log odds and the probability of an event
<ul>
<li>Intercept is log odds of first group</li>
<li>Estimates for other groups are the ratio of log odds</li>
<li>Transform from log odds to odds using <code>exp()</code></li>
</ul></li>
</ul>
<p><strong>Question 4</strong> - What is the function to conduct an Poisson regression in R?</p>
<div id="melanoma-tumor-thickness-and-survival" class="section level3">
<h3>Melanoma tumor thickness and survival</h3>
<p>Data is <code>Melanoma</code> from <code>MASS</code>. I have manipulated the data so it is suitable for analysis - code below.</p>
<pre class="r"><code>Melanoma &lt;- MASS::Melanoma
Melanoma &lt;- subset(Melanoma, Melanoma$status != 3) # remove observations of other causes of death
Melanoma$status &lt;- Melanoma$status - 1 # create binary variables: 0 = died, 1 = alive

# binary regression
model &lt;- glm(status ~ thickness, Melanoma, family = binomial)
summary(model)</code></pre>
<pre><code>
Call:
glm(formula = status ~ thickness, family = binomial, data = Melanoma)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8588  -1.2162   0.6729   0.7485   1.8844  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.61134    0.25496   6.320 2.62e-10 ***
thickness   -0.24853    0.06354  -3.911 9.18e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 232.84  on 190  degrees of freedom
Residual deviance: 213.45  on 189  degrees of freedom
AIC: 217.45

Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>plot(status ~ thickness, Melanoma, pch = 19) # plot
# plot binomial regression in blue
newdat &lt;- data.frame(thickness=seq(min(Melanoma$thickness), max(Melanoma$thickness),len=100))
newdat$status &lt;- predict(model, newdata=newdat, type=&quot;response&quot;)
lines(status ~ thickness, newdat, col=&quot;blue&quot;, lwd=2)</code></pre>
<p><img src="docs/teaching/GLM/04-GLM_files/figure-html/Melanoma-1.png" width="300" style="display: block; margin: auto;" /></p>
<p><strong>Question 5</strong> - Is there a relationship between Melanoma tumour thickness (mm) and whether a patient survives?</p>
<p><strong>Question 6</strong> - What does the coefficient estimate of <code>-0.24853</code> for the variable <code>thickness</code> represent?</p>
<p><strong>Question 7</strong> - What is the probability of survival with a tumour 5 mm thick?</p>
<blockquote>
<p>Wear sunscreen!</p>
</blockquote>
<hr />
</div>
</div>
</div>
