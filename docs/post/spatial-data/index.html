<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jacinta Kong">

  
  
  
    
  
  <meta name="description" content="A basic workflow with rasters and spatial points">

  
  <link rel="alternate" hreflang="en-us" href="https://jacintak.github.io/post/spatial-data/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jacintak.github.io/post/spatial-data/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@jacintakong">
  <meta property="twitter:creator" content="@jacintakong">
  
  <meta property="og:site_name" content="Jacinta&#39;s Website">
  <meta property="og:url" content="https://jacintak.github.io/post/spatial-data/">
  <meta property="og:title" content="An introduction to spatial data in R | Jacinta&#39;s Website">
  <meta property="og:description" content="A basic workflow with rasters and spatial points"><meta property="og:image" content="https://jacintak.github.io/post/spatial-data/featured.png">
  <meta property="twitter:image" content="https://jacintak.github.io/post/spatial-data/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-10-01T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-10-01T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jacintak.github.io/post/spatial-data/"
  },
  "headline": "An introduction to spatial data in R",
  
  "image": [
    "https://jacintak.github.io/post/spatial-data/featured.png"
  ],
  
  "datePublished": "2021-10-01T00:00:00Z",
  "dateModified": "2021-10-01T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Jacinta Kong"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Jacinta's Website",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jacintak.github.io/img/icon-512.png"
    }
  },
  "description": "A basic workflow with rasters and spatial points"
}
</script>

  

  


  


  





  <title>An introduction to spatial data in R | Jacinta&#39;s Website</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">Jacinta&#39;s Website</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/CV/"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>An introduction to spatial data in R</h1>

  

  
    




<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
    
      
    
    Published 1 Oct 2021
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/code/">code</a></span>
  

</div>

    













<div class="btn-links mb-3">
  
  








  









  
  <a class="btn btn-outline-primary my-1 mr-1" href="/project/NERD-club/">
    Project
  </a>
  











</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://jacintak.github.io/post/spatial-data/index_files/header-attrs/header-attrs.js"></script>


<p>NB: This was originally a tutorial given to Space Lunch members on 6th October 2021. This is an adapted version. The original version can be found on the <a href="project/NERD-club/">Project</a> page.</p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This is going to be an introduction to a simple workflow for spatial data in R using rasters. I will assume you have some basic knowledge about spatial analyses and co-ordinate systems. This is not meant to be a documentation of the full suite of spatial analysis available in R. Some simple ways of plotting data is covered.</p>
<p>Rasters are stored spatial data in a gridded format.</p>
<ul>
<li>Each grid cell contains a single value. E.g. temperature, elevation, species richness</li>
<li>Often stored in three dimensions (e.g. latitude, longitude and time).</li>
<li>The main <code>R</code> package for handling rasters is <code>raster</code>. It’s a base package.</li>
</ul>
<p>We will consider a common workflow of associating rasters with spatial point data (e.g. lat and long).
I will be sticking to base R throughout.</p>
<hr />
</div>
<div id="introducing-rasters" class="section level1">
<h1>Introducing rasters</h1>
<div id="loading-from-file" class="section level2">
<h2>Loading from file</h2>
<p>Rasters can be acquired from a range of sources, such as government agencies. There are also R packages to interface directly with online databases but for another time. Often they are saved as an nc file (network Common Data Form) that is imported as a raster with layers and assigned a spatial projection. You’ll see below that other dependent packages are loaded with <code>raster</code> but you won’t need to load each one manually.</p>
<p>You can load a raster from a local nc file using the function <code>raster::brick</code>. The <code>::</code> denotes calling a function from a specific package without loading it with <code>library</code>. Good for quick and dirty functions you won’t use frequently, bad if you are using the package multiple times.</p>
<pre><code>my_raster &lt;- brick(&quot;raster_data.nc&quot;)</code></pre>
<p>I will cheat and use the built in function in <code>raster</code> to query WorldClim for mean annual temperature.</p>
<pre class="r"><code>library(raster)</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre class="r"><code>temp &lt;- getData(&quot;worldclim&quot;,var=&quot;bio&quot;,res=10)</code></pre>
</div>
<div id="subsetting-rasters" class="section level2">
<h2>Subsetting rasters</h2>
<p>Subset rasters by layers using basic square bracket subsetting for lists.</p>
<pre class="r"><code>temp &lt;- temp[[1]] # Subset only the first layer - mean annual temperature</code></pre>
<p>Here I have selected mean annual temperature since we do not need the other variables.</p>
</div>
<div id="plot-rasters" class="section level2">
<h2>Plot rasters</h2>
<p>We can use the basic plot function to view the raster data.</p>
<pre class="r"><code>plot(temp)</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-3-1.png" alt="Average annual temperature" width="672" />
<p class="caption">
Figure 1: Average annual temperature
</p>
</div>
<p>The default colour scale is horrendous so we will change it to the viridis scale. Here’s an example of using <code>::</code>. I don’t need the entire <code>viridis</code> package. This is to make a continuous colour palette of 20 colours. And add a title to the graph.</p>
<pre class="r"><code>plot(temp, main = &quot;Mean annual temperature&quot;, col = viridis::viridis(n = 20))</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-4-1.png" alt="That's better" width="672" />
<p class="caption">
Figure 2: That’s better
</p>
</div>
<p>There’s one last issue to deal with before this data is ready. WorldClim stores temperature data multiplied by 10 for space saving so we need to divide by 10.</p>
</div>
<div id="manipulating-rasters" class="section level2">
<h2>Manipulating rasters</h2>
<p>Rasters can be manipulated by base functions. E.g. addition or subtraction between rasters or layers. There are many other functions for analysing rasters and doing spatial analysis (e.g. interpolation) but we won’t cover that here.</p>
<pre class="r"><code>temp &lt;- temp/10
plot(temp, main = &quot;Mean annual temperature&quot;, col = viridis::viridis(n = 20))</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-5-1.png" alt="That's much much better" width="672" />
<p class="caption">
Figure 3: That’s much much better
</p>
</div>
<hr />
</div>
</div>
<div id="spatial-point-data" class="section level1">
<h1>Spatial point data</h1>
<p>I usually encounter spatial data in the form of decimal latitude and longitudes representing species occurrences or sampling sites. You may already have these data from your own work but for demonstration purposes I will show how to query an online database to get species distribution points from GBIF. This requires an Internet connection and the R package <code>rgbif</code>.</p>
<p>Let’s query GBIF occurrence points for an widespread bird: The house sparrow (<em>Passer domesticus</em>).</p>
<ul>
<li>You need the unique identification key for the species you want. <code>name_suggest</code> can help with that so you don’t have to manually search GBIF.</li>
<li>The data comes as a list with some metadata. <code>.$data</code> is the actual occurrence records. The dot <code>.</code> is a placeholder meaning it represents an R variable (e.g. a dataframe). This is commonly used in <code>tidyverse</code> and piping via <code>magrittr</code>. It is also a cheat’s way of using base functions within a pipe.</li>
<li>Co-ordinates are stored as <code>decimalLatitude</code> and <code>decimalLongitude</code>. I’ve removed any missing values.</li>
</ul>
<pre class="r"><code>library(rgbif)
# get ID key for bird
bird_key &lt;- name_suggest(q =&quot;Passer domesticus&quot;, rank=&#39;species&#39;)$data$key[1]
# get occurence points
bird_points &lt;- occ_search(taxonKey = bird_key) # Get all records, max 500 (see variable limit)
# exclude metadata
bird_points &lt;- bird_points$data
# remove NA latitude or longitude
bird_points &lt;- bird_points[!is.na(bird_points$decimalLatitude),]</code></pre>
<p>Since I’ve only searched for one species, the workflow is simple. If I wanted multiple species I would have to use lists and a function like <code>sapply</code>. See help file for <code>occ_search</code> for an example. Avoid for loops.</p>
<div id="plot-spatial-data" class="section level2">
<h2>Plot spatial data</h2>
<p>Let’s look at the global distribution of points. I will use the base <code>maps</code> package for a simple, low resolution and unprojected world map in R (not recommended for more professional output). The <code>maps</code> package can also be used in <code>ggplot2</code> via <code>borders(database = "world", fill = NA)</code> or <code>geom_polygon(data = map_data("world"), aes(x=long, y = lat, group = group), fill = NA, col= 1)</code>; <code>coord_map()</code> may help in these cases.</p>
<pre class="r"><code>library(maps)
map(&quot;world&quot;) # get basic world map
title(main = &quot;The distribution of house sparrow&quot;) # plot title
points(decimalLatitude ~ decimalLongitude, bird_points, pch = 16, col = 2) # plot points
legend(x = -150, y= -50, legend = &quot;occurence&quot;, pch = 16, col = 2, bty = &quot;n&quot;)</code></pre>
<p><img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We see that points come mainly from around northern Europe.</p>
<p>For more advanced mapping in R check out <code>ggmaps</code>, which can interface with Open Street Maps (free) and Google Maps (for a fee), and <code>osmdata</code>, which interfaces directly with OSM and allows you to customise which features to include - check out the related tutorial about mapping cities in R in the Space Club folder or <a href="https://jacintak.github.io/post/2021-07-01-OSM-in-R/">online</a>.</p>
<hr />
</div>
</div>
<div id="putting-it-all-together" class="section level1">
<h1>Putting it all together</h1>
<p>Now we have all the data we need, let’s combine the datasets and plot the occurrence data with the temp raster.</p>
<pre class="r"><code>plot(temp, main = &quot;Mean annual temperature&quot;, col = viridis::viridis(n = 20)) # temp
points(decimalLatitude ~ decimalLongitude, bird_points, pch = 16, col = 1) # bird</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-8-1.png" alt="The distribution of sparrows with mean annual temperature" width="672" />
<p class="caption">
Figure 4: The distribution of sparrows with mean annual temperature
</p>
</div>
<p>Let’s do some simple extraction of data.</p>
<hr />
<div id="what-range-of-temperatures-do-house-sparrows-live-in" class="section level2">
<h2>What range of temperatures do house sparrows live in?</h2>
<p>We can use our new species distribution points to query the raster and extract values corresponding with the occurrence points. The function to query a raster is <code>raster::extract</code>. The same can be used within <code>tidyverse</code> via <code>mutate</code>.</p>
<pre class="r"><code># Get temp
temps &lt;- extract(temp, SpatialPoints(cbind(bird_points$decimalLongitude, bird_points$decimalLatitude)), method = &quot;bilinear&quot;)
# Add new column
bird_temps &lt;- cbind(bird_points, temps) 
# Remove missing temps
bird_temps &lt;- bird_temps[!is.na(bird_temps$temps),]</code></pre>
<p><code>method = "bilinear"</code> tells the function to interpolate the average of the nearest 4 cells around the spatial point. This is like a mini version of <code>buffer</code> which will interpolate values within a buffer around a point. If spatial accuracy is not paramount (like here where we have a global scale raster), then this method might reduce the chance of extracting a <code>NA</code> value. The default is to query the exact coordinate.</p>
<p>Our final dataset contains 500 observations.</p>
<p>Missing data at this stage could be from a mismatch between the accuracy of the spatial points and the resolution of the raster. Or plain errors in the spatial coordinates.</p>
<p>Now we can plot the distribution of temperatures:</p>
<pre class="r"><code>hist(bird_temps$temps, main = &quot;Temperature distribution of house sparrows&quot;)</code></pre>
<p><img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We can see they live between -2.7 and 11.6 °C.</p>
<p>Finally, we can plot the relationship between temperature and latitude:</p>
<pre class="r"><code>plot(temps ~ decimalLatitude, bird_temps, pch = 16)</code></pre>
<p><img src="https://jacintak.github.io/post/spatial-data/index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><em>End</em></p>
</div>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/code/">code</a>
  
  <a class="badge badge-light" href="/tags/R-stats/">R stats</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jacintak.github.io/post/spatial-data/&amp;text=An%20introduction%20to%20spatial%20data%20in%20R" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jacintak.github.io/post/spatial-data/&amp;t=An%20introduction%20to%20spatial%20data%20in%20R" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=An%20introduction%20to%20spatial%20data%20in%20R&amp;body=https://jacintak.github.io/post/spatial-data/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=An%20introduction%20to%20spatial%20data%20in%20R%20https://jacintak.github.io/post/spatial-data/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar.jpg_hu3485d9da5728a67f0e405792ef3b9866_160517_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jacintak.github.io/">Jacinta Kong</a></h5>
      <h6 class="card-subtitle">Teaching and Research Fellow</h6>
      <p class="card-text">My research interests include species distributions, phenology, microclimates &amp; mechanistic niche modelling.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/kongj@tcd.ie" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/jacintakong" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=637pv-sAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jacintak" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0002-1085-8612" target="_blank" rel="noopener">
        <i class="fab fa-orcid"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/purrr/">Beyond the valley of intermediate competence</a></li>
      
      <li><a href="/teaching/introR/">Setup R</a></li>
      
      <li><a href="/post/2021-08-01-rphylopic/">How to add a Phylopic icon to your graph in R</a></li>
      
      <li><a href="/post/2021-07-01-OSM-in-R/">OSM in R</a></li>
      
      <li><a href="/project/NERD-club/">NERD club tutorials</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    

<footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by 
    <a href="https://bookdown.org/yihui/blogdown/" target="_blank" rel="noopener">blogdown</a> and the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
