[{"authors":["admin"],"categories":null,"content":"I want to know where animals live and how they persist in their environment. Functional traits are a focus of my work because traits are how organisms interact with their environment.\nMy research follows a general theme of the effect of temperature on ectotherms to understand the ecological and evolutionary processes underlying biological patterns. My interests lie at the intersection between ecology, evolutionary biology and climate adaptation.\nI answer these questions through an integrative combination of field observations, manipulative laboratory experiments and computer modelling in R, grounded within a theoretical framework.\n","date":-62135596800,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":1607952483,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://jacintak.github.io/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"I want to know where animals live and how they persist in their environment. Functional traits are a focus of my work because traits are how organisms interact with their environment.\nMy research follows a general theme of the effect of temperature on ectotherms to understand the ecological and evolutionary processes underlying biological patterns. My interests lie at the intersection between ecology, evolutionary biology and climate adaptation.\nI answer these questions through an integrative combination of field observations, manipulative laboratory experiments and computer modelling in R, grounded within a theoretical framework.","tags":null,"title":"Jacinta Kong","type":"authors"},{"authors":null,"categories":null,"content":"These are course notes about statistical modelling in R for Statistics and Computation.\n Other resources  Seeing Theory. Chapter 6. https://seeing-theory.brown.edu/regression-analysis/index.html Statistics: an introduction using R. Michael J. Crawley. Wiley Press. Chapters 7 - 11. Experimental Design and Data Analysis for Biologists. Gerry P. Quinn \u0026amp; Michael J. Keough. Cambridge Press. Chapters 5, 6, 8, 12. R for Data Science (For more advanced R). https://r4ds.had.co.nz/index.html https://learningstatisticswithr.com/book/index.html An interactive visual explanation of hierarchical Models  Using datasets Datasets used here are from the package MASS which comes with R. To use any data in MASS, library(MASS) needs to be loaded first.\n","date":-62135596800,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1607968911,"objectID":"dbf3bfcc73ad3e637c63fbce8d647a8c","permalink":"https://jacintak.github.io/teaching/GLM/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/GLM/","section":"teaching","summary":"Course notes on statistical modelling","tags":null,"title":"Statistical Modelling","type":"docs"},{"authors":null,"categories":null,"content":"\r\r\rOverall lecture aims\r\rIdentify the structure of general linear models\rDescribe how linear models are parametrized\rUnderstand how to use linear models\rUnderstand how to interpret and evaluate linear models\r\rRecommended reading:\rChapter 5.5 Getting Started with R\nBy the end of this lecture you should:\r\rDescribe the structure of a general linear model\rUnderstand how a simple linear model is parametrised\rUnderstand what the parameters of a linear model represent\rParametrise a simple linear model from given information\rInterpret a simple linear model in a graphical format\r\rIn R:\n\rUse built-in R datasets and R libraries\rConduct a simple linear model\r\r\r\rHeight and girth of trees\rImagine we measured the height and girth of trees to test the hypothesis that thicker trees are taller.\nHow should test our hypothesis? We could assign trees to categories like “thick” or “thin” trees and do a t-test. What does our t-test say?\n\rWelch Two Sample t-test\rdata: Height by Thickness\rt = 1.6339, df = 28.168, p-value = 0.1134\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r-0.9240387 8.2181563\rsample estimates:\rmean in group Thick mean in group Thin 78.00000 74.35294 \rBut this isn’t the best way\r\rHow did we define “thick” or “thin”?\rWe lost information using groups - tree girth is not categorical data, it’s continuous\rThis increases unexplained variance = bad!\rWhen might you want to group data?\r\r\r\rLinear regression\r\rmodels the linear relationship between 2 continuous variables\n\r\rContinuous response variable (Y)\rContinuous predictor variable (X)\r\r\rFigure 1: Fit a line\r\rWhat does linear mean?\r\rBy definition, all predictor parameters should not be divided by each other\rNo parameter is an exponent\rNo parameter is multiplied or divided by another\r\rNot a linear model:\n\\(H_a = \\frac{a \\times H \\times T}{1 + a \\times H \\times T}\\) e.g. Holling’s Type II predation equation\n\\(y = \\frac{\\beta_1 x}{\\beta_2 x}\\) e.g. enzyme rate of reactions\n\rWhy do we use a linear model?\r\rQuantify a relationship\r\rE.g. relationship between drug concentration and time\r\rPredict what will happen\r\rE.g. growth at different time points\r\rExplain as much about the response variable as possible\rPartition variation\r\rE.g. Phenotypic variation = genetic variation + environmental variation\r\r\r\r\rStructure of a general linear model\r\r\\[Y = intercept + slope \\times X\\]\n\rIntercepts and slopes can be mathematically represented by any symbol or letter but conventionally the equation is written as:\n\\[y_i = \\beta_0 + \\beta_1 \\times x_i + \\varepsilon_i\\]\nWhere \\(i\\) refers to individual data points.\nVariables of a linear model\rVariables are \\(y_i\\) and \\(x_i\\)\n\\(y_i\\) = response variable, what you are interested in, e.g. height\n\\(x_i\\) = predictor variable, what you are manipulating, e.g. girth\n\rParameters of a linear model\rParameters are what we don’t know and we need to work out (parametrise). They are \\(\\beta_0\\) and \\(\\beta_1\\).\n\\(\\beta_0\\) = population intercept, value of y when x is 0, constant\n\\(\\beta_1\\) = population slope, unit change in y with a unit change in x\n\\(\\varepsilon_i\\) = the residual of the model (how much the line gets wrong for each data point or what is left over), also called random error\n\r\rOrdinary least squares regression\rOrdinary least squares regression (OLS) is the technique used to parametrise the linear model by finding the ‘best fitting’ line.\n\rThe aim is to make the sum of the squared residuals, \\(\\sum{\\varepsilon_i^2}\\), as small as possible\n\rMeaning calculating the difference between each point and the line, squaring that difference and adding it all up (Figure 2).\nResiduals are squared to make all values positive - remember points can fall above and below the best fit line.\n\rFigure 2: Residuals (blue lines) are the difference between the data point and the predicted line (black line)\r\rFinding the intercept\r\rWhy not extrapolate to 0?\rWe know \\(\\bar{y}\\) and \\(\\bar{x}\\) - the means of x and y\rWe can rearrange the linear equation to \\(\\beta_0 = \\bar{y} - \\beta_1 \\bar{x}\\) where \\(\\beta_1\\) is the estimated slope\rBut R will do all this for you!\r\r\r\rHalfway there! Revision time!\rTest your understanding so far by answering the questions below. Click Code to see the answer.\nWhat types of variables are used in simple linear regression?\nBoth the response and predictor variable should be continuous. (Categorical predictor variables are also allowed as we will see in later lectures)\rWhat is the method for parameterising linear models called?\nOrdinary least squares regression. The aim is to minimise the sum of squared residuals.\rWhat is random error in linear regression?\nThe variation in data that cannot be explained by the linear model. i.e. the difference between the predicted value of the model and the observations: the residuals. Denoted ε.\r\rWhat does a linear model tell us?\r\rWhat will Y be, given a new value of X?\rDoes the population slope \\(\\beta_1\\) differ to 0?\r\r\rBack to trees\rThe function lm() in R stands for linear model. It will do the OLS calculations for us. The function takes data in the form lm(Y ~ X, data). Use summary() on your lm to get more information.\n\rCall:\rlm(formula = Height ~ Girth, data = trees)\rCoefficients:\r(Intercept) Girth 62.031 1.054 \rHere the (Intercept) is the value of the intercept, \\(\\beta_0\\) and Girth is the slope of the model, \\(\\beta_1\\).\nWe then put these numbers in our linear model equation to get the parametrised linear model\n\\(Y = \\beta_0 + \\beta_1 \\times X\\)\nbecomes \\(Height =\\) 62.031 + 1.054 \\(\\times Girth\\)\n\rFigure 3: Does the above equation match this line?\r\r\rCalculating a new value of Y\rWe can use the parametrised equation to work out the height of a tree for any value of girth. If a tree is 10cm thick, what is its predicted height?\n\\(Height =\\) 62.031 + 1.054 \\(\\times Girth\\)\r\\(Height =\\) 62.031 + 1.054 \\(\\times 10\\)\n\\(Height =\\) 72.571 cm\n\rDoes the population slope \\(\\beta_1\\) differ to 0?\rTypically we are more interested in the value of the slope than the intercept. We want to know if the slope of the fitted line is statistically different to 0 because that represents our hypotheses:\n\rNull hypothesis (in orange, Figure 4):\r\\[H_0: \\beta_1 = 0\\]\rAlternative hypothesis (Figure 5):\r\\[H_1: \\beta_1 \\neq 0\\]\n\r\rFigure 4: Hypotheses of linear models\r\r\rFigure 5: Regression lines can have positive (blue) or negative (red) slopes, either are H1\r\rTesting linear model parameters in R\rR will conduct a statistical test on the model parameters for us. You can see it using summary(lm())\n\rCall:\rlm(formula = Height ~ Girth, data = trees)\rResiduals:\rMin 1Q Median 3Q Max -12.5816 -2.7686 0.3163 2.4728 9.9456 Coefficients:\rEstimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 62.0313 4.3833 14.152 1.49e-14 ***\rGirth 1.0544 0.3222 3.272 0.00276 ** ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rResidual standard error: 5.538 on 29 degrees of freedom\rMultiple R-squared: 0.2697, Adjusted R-squared: 0.2445 F-statistic: 10.71 on 1 and 29 DF, p-value: 0.002758\r\rThe P values above test whether our slope is significantly different to 0\rTested like a single parameter t-test (why?)\r\rWhat are the degrees of freedom?\r\r\rBased on the R output above, does our estimated slope for Girth differ to 0 and what can we conclude about our hypothesis?\n\r\r\rProbability distribution functions (PDF)\r\rLinear models need a descriptor of how response variables (or errors) should be distributed\n\rProbability distributions\n\rE.g. Gaussian/normal distribution\rGrouped by “family”\rOther types exist but not covered here – same principles apply, called generalised linear models (GLM)\r\r\rFigure 6: a normal distribution with mean = 0 and sd = 1\r\rLinear models in the Gaussian family\r\rSame principles, different names\n\r\rLinear regression\r\rcontinuous response\rone or more continuous predictors\r\rAnalysis of Variance (ANOVA)\r\rcontinuous response\rcategorical predictors\r\rAnalysis of Covariance (ANCOVA)\r\rcontinuous response\rA mix of continuous and categorical predictors\rSpecial case with special assumptions\r\r\rYou have seen these statistical tests in previous lectures\r\rWelch Two Sample t-test\rdata: Height by Sex\rt = -12.924, df = 192.7, p-value \u0026lt; 2.2e-16\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r-15.14454 -11.13420\rsample estimates:\rmean in group Female mean in group Male 165.6867 178.8260 \r\r\r\rDf\rSum Sq\rMean Sq\rF value\rPr(\u0026gt;F)\r\r\r\rSex\r1\r8974.12\r8974.1197\r165.1145\r3.8618e-28\r\rResiduals\r206\r11196.29\r54.3509\rNA\rNA\r\r\r\rA one-way ANOVA is mathematically identical to a t-test\n\rIn this module, don’t focus on memorising what kind of test fits what kinds of data\n\rThey are all variants on general linear models anyway…\n\rWe are interested in slopes and (to a lesser extent) intercepts\rUnderstand how these models relate to your hypotheses \u0026amp; experimental design\r\r\r\r\rRevision time!\rTest your understanding so far by answering the questions below. Click Code to see the answer.\nWhat is the function in R to conduct a linear regression?\nThe function is lm().\rHow do you find a predicted value of a response for a given predictor value using a parameterised linear model?\nSubstitute the value of the predictor in the parameterised linear model and solve it.\rif Y = 10 * X + 6 and X = 2:\rY = 10 * 2 + 6 = 20 + 6\rY = 26 \rWhat is the probability distribution function of linear regression?\nThe normal distribution. Also called Gaussian.\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607968911,"objectID":"7a7ba3d0080de11df7f4defe4fb18718","permalink":"https://jacintak.github.io/teaching/GLM/GLM1/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/GLM/GLM1/","section":"teaching","summary":"Overall lecture aims\r\rIdentify the structure of general linear models\rDescribe how linear models are parametrized\rUnderstand how to use linear models\rUnderstand how to interpret and evaluate linear models\r\rRecommended reading:\rChapter 5.5 Getting Started with R\nBy the end of this lecture you should:\r\rDescribe the structure of a general linear model\rUnderstand how a simple linear model is parametrised\rUnderstand what the parameters of a linear model represent\rParametrise a simple linear model from given information\rInterpret a simple linear model in a graphical format\r\rIn R:","tags":null,"title":"Simple regression","type":"docs"},{"authors":null,"categories":null,"content":"\r\r\rOverall lecture aims\r\rIdentify the structure of general linear models\rDescribe how linear models are parametrized\rUnderstand how to use linear models\rUnderstand how to interpret and evaluate linear models\r\rRecommended reading:\rChapter 5.5 Getting Started with R\nBy the end of this lecture you should:\r\rUnderstand the parameters of a linear model with multiple predictor variables\rParametrise and use a multiple regression model to predict values from the R output of a linear regression\rInterpret and complete ANOVA tables with multiple predictor variables\rUnderstand an interaction between two predictor variables\rConduct a multiple regression in R with 2 continuous or categorical predictor variables or a combination\r\r\r\rPreviously, we parametrised slopes and intercepts of simple linear models\rWith one continuous response variable and one continuous predictor variable\n\\[Y = \\beta_0 + \\beta_1 X\\]\nwhere the parameters \\(\\beta_0\\) = intercept and \\(\\beta_1\\) = slope\nSo far these parameters have been fixed…\n\rParameters of a linear model can be random or fixed\r\rImportant to consider when designing experiments – you decide!\rChanges the hypotheses \u0026amp; interpretation of results\rFixed:\rConstant across all groupings (how observations are related – e.g. populations of individuals)\rRandom:\rVary across groupings, or represent a random sample from a larger population\r\rFixed slopes linear model\r\rAll groups (Frequency of exercise in this example) have the same slope\rResponse of groups to predictor variable x is consistent across groups\rCannot extrapolate beyond groups\rThus can only draw conclusions for these groups\r\r\rFigure 1: Height of students of various frequencies of exercise and hand width\r\r\rRandom slopes linear model\r\rAll groups have different slopes\rResponse of groups to predictor variable x varies among groups\rCan extrapolate beyond observed groups\rIdentity of group is not the main question\rThus can generalise to other groups outside study\r\r\rFigure 2: Each group has a different slope\r\r\rDistinguishing between Fixed or random is important\r\rChanges the way Analysis of Variance (ANOVA) is calculated\n\r\rChanges formula for Mean Sum of Squares\rChanges numerator/denominator of F ratio\rThus changes interpretation\rCalled Type I (fixed), II (random) or III (mixed)\r\r\r\rt-tests, simple linear models, ANOVA\r\rPredictor variables can be categorical (called factors in R), like exercise in Figures 1 \u0026amp; 2\rCan have two or more sub-categories (called levels in R)\r\rE.g. sex: male/female, level of drug: low/medium/high\r\r\rTypically, the relationship between a continuous response variable \u0026amp; categorical predictors is analysed using a special case of statistical models: One-way Analysis of Variance (ANOVA)\nConfusingly, ANOVA can refer to how data are spread around a single mean (variance) and also a way of comparing means (via how similar their variances are) for experimental designs with a predictor variable with any number of levels.\n\rFixed one-way ANOVA with 2 or more levels\r\rlevel = subsets within categories\r\re.g. male/female, low/medium/high\r\rWe are testing means for each level\rWhat is the null hypothesis?\r\r\r\\(H_0:\\) All levels come from the same population (have the same mean)\n\rPulse rate and exercise\rWe can do an ANOVA and get the following output:\nAnalysis of Variance Table\rResponse: Pulse\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F) Exer 2 900.5 450.23 3.3783 0.03618 *\rResiduals 189 25188.2 133.27 ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r\rConclusions: We can reject the null hypothesis that there is no difference in mean pulse rate of students with different amount of exercise\n\rReport the degrees of freedom (df), the F ratio and the P value like\r\\[F_{2,189} = 3.38, P = 0.036\\]\rWhere 2 is the df of the groups (Exer) and 189 is the df of the residual error (Residuals).\n\r\rThe ANOVA table\r\r\r\rSource of variation\rSS\rdf\rMS\rF\rP\r\r\r\rVariance among groups\rSSR\rnumber of levels - 1\r\\(MSR = \\frac{SSR}{df}\\)\r\\(\\frac{MSR}{MSE}\\)\r\r\rVariance within group\rSSE\rnumber of observations - 2\r\\(MSE = \\frac{SSE}{df}\\)\r\r\r\rTotal error\rSSY\rtotal number of observations - 1\r\r\r\r\r\r\rCalculating group means\rCheck summary() to see group means\n\rCall:\rlm(formula = Pulse ~ Exer, data = survey)\rResiduals:\rMin 1Q Median 3Q Max -41.188 -7.968 -0.188 7.812 32.032 Coefficients:\rEstimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 71.968 1.184 60.763 \u0026lt;2e-16 ***\rExerNone 4.796 3.040 1.578 0.116 ExerSome 4.219 1.752 2.408 0.017 * ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rResidual standard error: 11.54 on 189 degrees of freedom\r(45 observations deleted due to missingness)\rMultiple R-squared: 0.03452, Adjusted R-squared: 0.0243 F-statistic: 3.378 on 2 and 189 DF, p-value: 0.03618\r\rGroups are calculated in alphabetical order - Here “Frequent” group is calculated first\rEstimate column shows the difference in means - see below\rP values test differences in pairs of means BUT should we be doing multiple comparisons? (no)\r\rModel coefficients:\n(Intercept) ExerNone ExerSome 71.968421 4.796285 4.219079 \rR-calculated means:\n Freq None Some 71.96842 76.76471 76.18750 \rManually calculated means for “None” group:\r71.9684211 + 4.7962848 = 76.7647059\nManually calculated means for “Some” group:\r71.9684211 + 4.2190789 = 76.1875\n\r\rANOVA and hypothesis testing\rImportant to remember:\n\rANOVA is a test of means (analysis of variance about the mean)\rF-ratio tells you that there is a difference in the means between pairs of groups but NOT which pairs are different\rNeed post-hoc tests like Tukey’s Honest Significant Differences (not covered in this lecture) to see which pairs are significantly different\r\r\rRecap time!\rTest your understanding so far by answering the questions below. Click Code to see the answer.\nWhat is the significance of fixed and random variables for drawing conclusions?\nIt changes the inferred conclusion. In fixed models, the identities of the groupings are the main level of inference whereas in random models we consider the identity of the group to be randomly selected from a wider pool of candidates. Thus we can generalise our findings beyond our selected groups in random models but are limited to the groups we selected in fixed models. For example, if we counted the population of 5 towns in Ireland and analysed the data using a fixed model, then we could only state our conclusion for those 5 towns and cannot draw conclusions for the whole of Ireland.\rWith a random model, we consider those 5 towns to be representitive of the whole of Ireland, we are not interested in those 5 towns in particular, thus we can generalise our conclusions to the whole of Ireland. E.g. those 5 towns were randomly selected from all the candidate towns to survey.\rWhat is the function to conduct an Analysis of Variance in R?\nEither summary(aov()) or anova(lm()) will do a Type I ANOVA. Type II and Type III models require additional packages.\rHow many groups were in the categorical predictor variable in this one-way analysis of variance? \\(F_{5,24} = 14.23, P \u0026lt; 0.001\\)\n6 groups. The degree of freedom for group is 5 and this is calculated from the number of groups - 1. So 5 + 1 = 6.\r\rMultiple regression\rWe can include more than 1 predictor variable in our models\n\rMultiple regression: Linear models with two or more predictor variables\n\r\rModels the effect of multiple predictors on response\rTwo-way ANOVAs etc. are special cases of multiple regression\rIf 3 categorical predictors, then three-way ANOVA etc…\rWith more predictor variables, the model becomes complex\r\rAnd potentially less informative/difficult to interpret\rRemember the trade-off between generality \u0026amp; complexity\rKeep it simple\r\r\rHeight and hand width\rImagine we asked the class is there a relationship between your height and the width of your hand?\nThe linear model is:\n\\[ height = \\beta_0 + \\beta_1 hand \\space width + \\varepsilon_i\\]\n\rFigure 3: The relationship between hand width and height of students\r\rGood, but let’s ask is it also important to consider the sex of the student?\n\rFigure 4: The relationship between hand width and height of male (yellow) or female (purple) students\r\r\rDoes including information about sex improve our ability to detect/understand patterns?\n\rThe linear model now has two predictor variables and is written as:\n\\[ height = \\beta_{0_{sex}} + \\beta_1 hand \\space width + \\varepsilon_i\\]\rNotice that the intercept parameter (\\(\\beta_{0_{sex}}\\)) now specifies that it is dependent on the sex of the student.\nSince Sex is a categorical predictor with 2 levels, this model now describes two lines - one for each level of the predictor (male/female)\nDoes student height vary with hand width and between sexes?\r\rContinuous response\rCategorical predictor\rContinuous predictor (also called covariate)\rCan be analysed using multiple linear models\rTwo types:\r\rAdditive model (Fixed slopes model)\rInteractive model (Random slopes model)\r\r\rAnalysis of Covariance is a special case with unique assumptions (not considered here), else called a general linear model\n\r\rFixed slopes (additive model)\r\rNo interaction term\rSame slope\rIntercept for each sex\rin R: lm(Y ~ A + B, data) where A \u0026amp; B are the two predictor variables\r\r\rH0: There is no effect of A or B on the response variable\rH1: There is an effect of A or B on the response variable\n\r\rFigure 5: the lines are parallel to each other\r\r(Intercept) Wr.Hnd SexMale 137.686951 1.594446 9.489814 \rParametrised slope for females:\nFemale height = 137.687 + 1.594 hand width\nParametrised slope for males:\nMale height = (137.687 + 9.49) + 1.594 hand width\n\rRemember R shows the difference between parameter estimates so you need to extract the correct values\n\r\rRandom slopes (interactive model)\rThe random slopes model has in interaction term. In R this is coded lm(Height ~ Wr.Hnd * Sex, survey).\nThe linear model is now:\n\\[ height = \\beta_{0_{sex}} + \\beta_{1_{sex}} hand \\space width + \\varepsilon_i\\]\n\rFigure 6: The lines have different slopes and intercepts\r\r (Intercept) Wr.Hnd SexMale Wr.Hnd:SexMale 147.4497131 1.0385045 -7.1567184 0.9020249 \rTo parametrise the model we now need to calculate different values for slopes. In the coefficient list, Wr.Hnd:SexMale is the difference in the value of the slope relative to the slope for female Wr.Hnd. Remember: female is alphabetically before male so R calculates the variances for females first, then males.\nParametrised slope for females:\nFemale height = 147.45 + 1.039 hand width\nParametrised slope for males:\nMale height = (147.45 -7.157) + (1.039 + 0.902) hand width\n\rH0: There is no effect of A or B or their interaction on the response variable\rH1: There is an effect of A or B or their interaction on the response variable\n\r\rThe multiple regression ANOVA table\r\rVariance of predictors (SS) is partitioned out from total SS in order it is entered in to R\n\r\r\r\rDf\rSum Sq\rMean Sq\rF value\rPr(\u0026gt;F)\r\r\r\rWr.Hnd\r1\r7298.70354\r7298.70354\r150.128633\r3.359137e-26\r\rSex\r1\r2912.37262\r2912.37262\r59.905231\r4.604092e-13\r\rWr.Hnd:Sex\r1\r90.06608\r90.06608\r1.852589\r1.749916e-01\r\rResiduals\r203\r9869.11550\r48.61633\rNA\rNA\r\r\r\r\rThe ANOVA table for 2 predictors and their interaction\r\r\rSource of variation\rSS\rdf\rMS\rF\rP\r\r\r\rFactor A\rSSR of A\rnumber of levels of A - 1\r\r\r\r\rFactor B\rSSR of B\rnumber of levels of B - 1\r\r\r\r\rFactor A x B\rSSR of A \u0026amp; B\rdf of A x df of B\r\r\r\r\rWithin error\rSSE\rlevels of A x levels of B X (number of observations - 1)\r\r\r\r\rTotal error\rSSY\r(levels of A x levels of B X number of observations) - 1\r\r\r\r\r\r\r\rInterpreting the ANOVA table\r\rP(Interaction term) \u0026gt; 0.05, thus the effect of hand width on\rstudent height is not dependent of the sex of the student\n\r\r\r\rDf\rSum Sq\rMean Sq\rF value\rPr(\u0026gt;F)\r\r\r\rWr.Hnd\r1\r7298.70354\r7298.70354\r150.128633\r3.359137e-26\r\rSex\r1\r2912.37262\r2912.37262\r59.905231\r4.604092e-13\r\rWr.Hnd:Sex\r1\r90.06608\r90.06608\r1.852589\r1.749916e-01\r\rResiduals\r203\r9869.11550\r48.61633\rNA\rNA\r\r\r\r\rThe interaction term A:B\r\rMeasures the dependence of the level of one factor on the level of the other factors\rIf interaction term is not significant:\r\reffect of one factor on other is additive (independent of each other)\r\rIf significant:\r\rindicates synergistic or antagonistic effects between factors\rShould be main conclusion of analysis\r\r\r\r\rThe fundamentals of Linear regression\rThat’s the basics of linear regression!\nThey are widely used in biological statistics so you’ll likely come across them when reading scientific studies.\nThe same concepts apply for any number or combination of predictor variables. Two, three, four predictor variables and so forth…it just becomes more complex to parameterise.\nRemember, the aim is to quantify how much variation in the response variable is attributable to each predictor variable - minimise those residuals!\nCommon statistical analyses you should be able to do by applying the concepts in these lectures:\r1 continuous response variable \u0026amp;:\n\r1 continuous predictor variable - simple linear regression\r2 continuous predictor variables (with/without their interaction) - multiple regression\r1 categorical predictor variable - One-way ANOVA\r1 continuous predictor variable \u0026amp; 1 categorical predictor variable (with/without their interaction) - ANCOVA/multiple regression\r2 categorical predictor variables (with/without their interaction) - Two-way ANOVA\r\r\rRecap time!\rTest your understanding so far by answering the questions below. Click Code to see the answer.\nWhat is the difference between an additive and interactive linear model?\nAn additive model does not describe an interaction between the two predictor variables. An interactive model describes that the effect of one predictor variable on the response variable is dependent on the second predictor variable.\rWhat is the function to conduct an interactive multiple regression model in R?\nlm(Y ~ A * B, data) where A \u0026amp; B are the two predictor variables. * denotes the interaction.\rA multiple regression of crab shell width (response) with crab body depth (continuous predictor) for two species (categorical predictor: B or O) and their interaction had the following coefficients:\n\r\r\rx\r\r\r\r(Intercept)\r2.6942643\r\rBD\r2.5449206\r\rspO\r-1.2531624\r\rBD:spO\r-0.1756934\r\r\r\rWhat is the predicted shell length (mm) of a species O crab with a body depth of 15mm?\nAnswer: 36.97951 mm\rBecause B is alphabetically before O, the first parameter coefficients refer to species B. The intercept for species O is 2.6942643-1.2531624 = 1.441102\rThe slope for species O is 2.5449206-0.1756934 = 2.369227\rThus the whole model for species O is:\rshell length = 2.369227 * body depth + 1.441102\rUsing a value of 15 for body depth:\rshell length = 2.369227 * 15 + 1.441102\r= 36.97951 mm\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607968911,"objectID":"624fbc7fc2a25699b40d3ea2b1330e01","permalink":"https://jacintak.github.io/teaching/GLM/GLM2/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/GLM/GLM2/","section":"teaching","summary":"Overall lecture aims\r\rIdentify the structure of general linear models\rDescribe how linear models are parametrized\rUnderstand how to use linear models\rUnderstand how to interpret and evaluate linear models\r\rRecommended reading:\rChapter 5.5 Getting Started with R\nBy the end of this lecture you should:\r\rUnderstand the parameters of a linear model with multiple predictor variables\rParametrise and use a multiple regression model to predict values from the R output of a linear regression\rInterpret and complete ANOVA tables with multiple predictor variables\rUnderstand an interaction between two predictor variables\rConduct a multiple regression in R with 2 continuous or categorical predictor variables or a combination\r\r\r\rPreviously, we parametrised slopes and intercepts of simple linear models\rWith one continuous response variable and one continuous predictor variable","tags":null,"title":"Multiple regression","type":"docs"},{"authors":null,"categories":null,"content":"\r\r\rOverall lecture aims\r\rIdentify the structure of general linear models\rDescribe how linear models are parametrized\rUnderstand how to use linear models\rUnderstand how to interpret and evaluate linear models\r\rBy the end of this lecture you should:\r\rKnow how the coefficient of determination is calculated and its interpretation\rUnderstand the assumptions of linear regression\rBe able to evaluate the appropriateness of a linear model to data based on residual plots\rBe able to identify generalised linear models appropriate for data\rCreate residual plots in R\rConduct a generalised linear model in R\r\r\r\rBy now you should be comfortable with building and interpreting basic linear models in R\r\rbut how do we know whether our model is a “good” one?\n\rWe need to evaluate our model. There are a few things we should consider:\nHow much variation in the data is explained by the model?\rAre linear models appropriate for our hypotheses?\r\r\rWhat does a linear model tell us?\rWhat will a new value of Y be, given a new value of X?\rDoes the population slope \\(\\beta_1\\) differ to 0?\rHow much variation in Y can be explained its linear relationship with X?\r\r\rCoefficient of determination (\\(R^2\\))\rPartitioning variance (F ratio)\r\r\rHow much variation in Y can be explained its linear relationship with X?\r\\[ \\frac{Var_{\\text{explained by the line}}}{Var_{\\text{not explained by the line}}} = Ratio\\]\rInterpreting ratios:\nRatio \u0026gt; 1 = Line explains more than residual\nRatio ≤ 1 = Line explains very little (null hypothesis)\n\rWe need to know the total amount of variation and all possible sources of variation (like the F-ratio \u0026amp; ANOVA)\n\rWhat is or isn’t explained by the line?\rIsn’t: Sum of Squares of the Error (SSY)\rThe bit not explained by the null (total variation in the data). Remember, the null is \\(\\bar{y}\\) = the mean of Y.\n\\[SSY = y_i - \\bar{y}\\]\n\rFigure 1: Black line is the mean of Y. Blue lines are the difference between the mean and a single observation = SSY\r\r\rIsn’t: Sum of Squares of the Residual (SSE)\rThe bit not explained by the line\n\\[SSE = y_i - \\hat{y_i}\\]\n\rFigure 2: Residuals (blue lines) are the difference between the data point and the predicted line (black line)\r\r\rIsn’t: Sum of Squares of the Regression (SSR)\rHow well the line estimates the mean of Y\n\\[SSR = \\hat{y_i} - \\bar{y}\\]\n\rFigure 3: Residuals (blue lines) are the difference between the null hypothesis (mean of observations, dashed lines) and the predicted line (black line)\r\r\rNotice that since SSY is all variation in the data:\nSSY = SSE + SSR\n\r\r\r\rSo which bits do we use to evaluate model “fit”?\r\\[ \\frac{Var_{\\text{explained by the line}}}{Var_{\\text{not explained by the line}}} = Ratio\\]\rWe want the number above the line (nominator) to be larger than the number below the line (denominator), otherwise we cannot be confident that our results are different to randomly generated numbers.\nInterpreting ratios:\nRatio \u0026gt; 1 = Line explains more than residual\nRatio ≤ 1 = Line explains very little (null hypothesis)\nIn other words, we want to know how much varaition is captured by the model relative to the total variation in our data.\nWhat is the error that tells us how much varaition the line is (H1) explaining relative to our null hypothesis (H0)?\nSSR - Sum of squares of the regression.\rWhat is the error that tells us the total variation in our data?\nSSY - Sum of squares of the error. Sometimes called SST - total sum of squares\rSo we can evaluate how much varaition the model explains by:\n\\[\\frac{SSR}{SSY} = R^2\\]\nWhy can’t we use SSE as the denominator?\nSSE depends on the total variation of Y. We could have more variation simply by having more data but the ratio values are the same. So using sum of squares does not tell us about how much variation is explained by our model in a way that is unbiased. \r\rCoefficient of determination \\(R^2\\)\r\rThis is the proportion of variation that your model (your line) explains\n\r1 = no deviance from line (good)\n0 = strong deviance from line (not good)\nIt is related to correlation coefficients (r). Basically, \\(R^2 = r^2\\)\n\rFigure 4: Which fits better?\r\rR will calculate \\(R^2\\) for you. Going back the tree height and girth example, the \\(R^2\\) is 0.27 (Multiple R-squared).\n\rCall:\rlm(formula = Height ~ Girth, data = trees)\rResiduals:\rMin 1Q Median 3Q Max -12.5816 -2.7686 0.3163 2.4728 9.9456 Coefficients:\rEstimate Std. Error t value Pr(\u0026gt;|t|) (Intercept) 62.0313 4.3833 14.152 1.49e-14 ***\rGirth 1.0544 0.3222 3.272 0.00276 ** ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rResidual standard error: 5.538 on 29 degrees of freedom\rMultiple R-squared: 0.2697, Adjusted R-squared: 0.2445 F-statistic: 10.71 on 1 and 29 DF, p-value: 0.002758\r\rConclusion: the model (your fitted line) explains 27 % of total variation in data\n\rBut…\n\rBiological data is messy, thus low \\(R^2\\) may be biologically acceptable\rLow \\(R^2\\) does not always mean a bad model\rConsider multiple regression to explain more variance\r\rbut adding more parameters is not always better. Why?\r\r\r\rBut there are other things to check that are more important!\r\rWe make assumptions of the error structure in linear regression (\\(\\varepsilon\\))\n\rRemember:\n\\[Y_i = \\beta_0 + \\beta_1 \\times X_i + \\varepsilon_i\\]\n\rDoes not change our estimates of \\(\\beta_0\\) or \\(\\beta_1\\)\rAffects our confidence intervals of the estimate and thus hypothesis testing\rBecause \\(\\varepsilon_i\\) is random, our assumptions also apply to the response variable \\(y_i\\)\r\r\rAssumptions of linear regression\rLinear models assume that the relationship between the response and predictor is linear. In addition to this main condition, there are 4 assumptions of linear regression:\nNormality\rHomogeneity of Variance\rIndependence\rFixed X\r\r\rALWAYS check these assumptions every time you fit a model. No exceptions! No excuses!\n\rResidual plots\rIn R, we can evaluate models from residual plots:\nModel \u0026lt;- lm(Y ~ X, data) # build a model\rplot(Model) # show residual plots\rThere are 4 plots called. In order:\nResiduals vs fitted values\r\rbits left over vs what the model predicted\r\rStandardised residual quantile-quantile plot\r\rwhat is the spread of the residuals?\r\rScale-Location\r\rlike plot 1 but shown differently\r\rResiduals vs Leverage\r\rare there any influential data points?\r\r\r\rMammal brain and body size\rLet’s look at these assumptions in detail using the relationship between brain mass and body mass for different mammals. The dataset is called mammals in the MASS package.\n\rFigure 5: The relationship between mammal body size and brain size\r\r\r\r1. Normality\r\rPopulation Y values and error terms (\\(\\varepsilon_i\\)) are normally distributed for each level of the predictor variable (\\(x_i\\))\n\rThe distribution of the response variable, Y, should be normally distributed (not skewed). We can graphically check this using a histogram of brain size.\nQuantile-Quantile plots\r\rWe can also visualise the spread of data with a quantile-quantile plot.\rThe linear line is the expected relationship following a normal distribution.\r\rDo our points follow the line?\rWhat does it mean when the points don’t follow the line?\r\r\r\rThe residuals of the model should be also normally distributed\r\rFigure 6: Looks like distribution of brain size is skewed to the right. What does this mean biologically?\r\r\rWhat happens when the data is not normal?\r\rCollect more data, increase sample size for each level of \\(x\\). Could be a sampling bias or sample size is too low\rUse a non-parametric test\r\re.g. Spearman’s Rank Correlation\r\rIgnore it (with good reason). Linear regressions are robust to skewness\rSome data are never normal\r\re.g. counts - should use Poisson distribution\rFit another statistical model with more appropriate error structures\r\rTransform the data\r\r\rApplying a transformation\r\rSome transformations:\r\rLog or natural log\rSquare root or cube root\r\rNote: log(0) or log(-1) is undefined so you could make data positive and greater than 0 before you log transform them.\rMore sophisticated transformations not covered in this module\r\r\rTransforming brain size\r\rLet’s try some transformations on the data\rWhat is the transformation doing?\rWhich would you choose?\r\r\rRe-run the model with transformed data\r\rFigure 7: That looks better!\r\rIf you transform data, then the model estimates refer to the transformed units. Remember to transform them back to their correct units.\n\r\r2. Homogeneity of Variance\r\rPopulation Y values and error terms (\\(\\varepsilon_i\\)) have the same variance for each level of the predictor variable (\\(x_i\\))\n\r\rRelated to the assumptions of Normality but more important!\rLook at patterns in standardised residuals:\r\rQuantile plot\rRelationship with fitted values (predicted Y values from line)\r\r\rCauses:\n\rsmall sample size\routliers\rnon-normally distributed variables\r\rFixes:\n\rHave properly designed experiments\n\rCollect enough data\n\rDeal with it like as normality\r\rShould expect a normal distribution of standardised residuals\r\rFigure 8: data falls along line = good\r\r\rAre there trends in the residual vs fitted values?\rExpect no relationship between standardised (or non-standardised) residuals and fitted values of model\n\rstraight line = good\rno humps or valleys\r\r\r\r3. Independence\r\rPopulation Y values and error terms (\\(\\varepsilon_i\\)) are independent\n\r\rThey do not influence each other (not autocorrelated)\rOften because of inappropriate experimental design\r\rtime series\rpseudo-replication\rrepeated measurements\r\rIncreases Type I error\r\rDealing with independence\rBest thing is to choose a different model\nConsider using random effects models or choosing better variables (i.e. good experimental design)\n\r\r4. Fixed X\r\rThe predictor variable (\\(x_i\\)) is fixed. i.e. a known constant\n\rCalled Type I model or fixed effects model\n\rOften broken in biological stats\rPredictor variables can be random\r\rCalled Type II (random effects model)\r\rHypothesis testing of Type I applies to Type II\r\r\rOther regression diagnostics\r\rHow well does the model fit the data?\r\rCoefficient of determination \\(R^2\\)\r\rIs a simple linear regression appropriate?\r\re.g. polynomial or curvilinear model\r\rAre there effects of outliers in the model?\r\rOutliers, leverage and influence\r\rOutliers are abnormal or unusual observations relative to the rest of the data that can cause biases during analysis\n\r\rOutliers can be checked before applying a model. How?\rSometimes caused by experimental error but sometimes significantly different data points are not outliers\r\rNatural variation\r\rLeverage = how much x influences y\rInfluence = how much x influences the slope of the line (Cook’s Distance)\r\rIf outliers are caused by experimental error or bias, you could justify excluding it from data.\nBut never delete observations to force a better model fit\n\rOutliers in the mammal dataset\r\rFigure 9: Looks like humans, water opossums \u0026amp; musk shrew have high influence on the regression\r\r\r\rPutting it all together\rThese assumptions can be checked by looking at the residual plots. R shows residual plots using the function plot(lm()).\nLet’s evaluate the residual plot, starting from the top left:\n\rAre the residuals vs fitted values equal (i.e. a straight line)? If there are humps or valleys, the model may not be appropriate for the data.\rAre the standardised residuals normally distributed? Linear models assume that residuals are normally distributed. If not, your model is inappropriate for your data or your data is skewed in some way.\rIs there a pattern to your \\(\\sqrt{\\mbox{Standardised residuals}}\\)? Linear models assume equal variance so there should be no pattern in your residuals.\rAre there any outlier data points that have strong leverage in the model? E.g. potential outliers or influential data points.\r\r\rANCOVA\rRemember Analysis of Covariance deals with the effect of two predictor variable, a continuous and categorical variable, on a continuous response variable. Like an ANOVA adjusted for the effect of an additional continuous covariate.\nFollows all the assumptions above plus two extra ones:\n1. Covariate values cover a similar range across groups\rData from groups should overlap across the range of the continuous variable\n\rFigure 10: Which of these violates ANCOVA assumptions?\r\rIf the first assumption is not met, ANCOVA fails to separate the effects of the two predictors on the response variable.\nExtending regression models beyond the range of data could be extrapolation and lead to incorrect conclusions.\n\r2. Regression slopes are similar across groups\rLike a fixed or additive linear regression.\nIf the second assumption is not met, you can still fit an “ANCOVA-like” model to the data with different slopes for different groups (i.e. a mixed or random model). Then it’s not a true ANCOVA in the classic sense.\n\r\rSome data are never normal\r\rNon-linear data - e.g. exponential growth of bacteria, human populations\rCounts or proportions, number of cells in petri dish, proportion of animals that survive\rCategorical data\r\rSimple linear regressions aren’t the most appropriate for these data and may give distorted results.\nBut we can use linear regression to analyse these data if we relax our assumptions a bit…called “general linear models”\n\rGeneralised linear models\r\rGeneral linear models, or just linear models (LM), refer to linear regression of data following a normal probability distribution, fixed or random. If we do a linear regression on based on a non-normal probability distribution that’s called a generalised linear model (usually abbreviated to GLM).\n\rThere are many types but we will briefly describe two common probability distributions:\n\rBinomial regression - for binomial data following a binomial distribution\r\ryes/no\ralive/dead\r\rPoisson regression - for count or contingency table data following a Poisson distribution\r\rIn R GLMs are done using glm(Y ~ X, data, family = \u0026lt;insert here\u0026gt;). family refers to the underlying probability distribution. Using family = gaussian is the same as lm() for a normal distribution. So:\n\rpoisson for a Poisson distribution\rbinomial for a binomial distribution\r\rBut the model outputs are interpreted differently to normal distributions because they link the relationship between the predictor and the response differently.\nPoisson regression\r\rUses a log linear link function where the response variable (counts) is on a log scale\rInterpretation is similar to lm with estimates for the intercept, slopes and differences in estimates among groups\r\rEstimates are the log of the expected count as a function of the predictor variables\rCannot have negative or 0 values because log(0) does not work - must deal with them. How?\r\rTest overall effects of predictors by comparing models with different predictors representing null and alternative hypotheses\rSee later lectures about Chi-Squared tests (\\(\\chi^2\\)).\r\rNumber of Oystercatchers (wetland birds) in South Africa\rData is waders from MASS. I have maniuplated the data so it is suitable for analysis - code below.\n# create data set of oystercatcher counts (column 1) and site labels\rwaders \u0026lt;- data.frame(Oystercatcher = MASS::waders[,1],\rsite = letters[1:15])\r# poisson regression\rsummary(glm(Oystercatcher + 1 ~ site, waders, family = poisson))\r\rCall:\rglm(formula = Oystercatcher + 1 ~ site, family = poisson, data = waders)\rDeviance Residuals: [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\rCoefficients:\rEstimate Std. Error z value Pr(\u0026gt;|z|) (Intercept) 2.5649 0.2774 9.248 \u0026lt; 2e-16 ***\rsiteb 2.0402 0.2948 6.920 4.51e-12 ***\rsitec 2.7233 0.2863 9.512 \u0026lt; 2e-16 ***\rsited -2.5649 1.0377 -2.472 0.0134 * sitee 1.7918 0.2996 5.981 2.22e-09 ***\rsitef 0.4308 0.3563 1.209 0.2266 siteg 4.3665 0.2791 15.645 \u0026lt; 2e-16 ***\rsiteh 1.9124 0.2971 6.436 1.23e-10 ***\rsitei 4.1058 0.2796 14.683 \u0026lt; 2e-16 ***\rsitej 1.8539 0.2983 6.215 5.12e-10 ***\rsitek 3.5984 0.2811 12.800 \u0026lt; 2e-16 ***\rsitel 1.7918 0.2996 5.981 2.22e-09 ***\rsitem 0.5705 0.3470 1.644 0.1001 siten -2.5649 1.0377 -2.472 0.0134 * siteo -2.5649 1.0377 -2.472 0.0134 * ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r(Dispersion parameter for poisson family taken to be 1)\rNull deviance: 5.3666e+03 on 14 degrees of freedom\rResidual deviance: 1.6653e-14 on 0 degrees of freedom\rAIC: 114.06\rNumber of Fisher Scoring iterations: 3\rWhy did I add 1 to the variable Oystercatcher in the poisson regression?\n1 is a dummy variable to remove 0s from the counts - or log(0) will mess up the estimation of parameters\rWhat is the link function for a poisson regression?\n(natural) log link\rWhat is the expected number of Oystercatchers at site k?\n474 oystercatchers\rRemember in linear regression (and by extension GLMs) the Intercept estimate is the estimated coefficient for the first site (site a) and the rest are the difference between site a and the respective site. So for site k you need to add the estimated coefficients together.\rCoefficient for k: 2.5649 + 3.5984 = 6.1633\rBut remember this is log counts so you need to transform it back to regular counts:\rexp(6.1633) = 474.993\rThen remember we added a dummy variable so you need to subtract that from our estimate:\r474.993 - 1 = 473.993 which rounded to the nearest whole number (as counts are discrete variables) is 474!\r\r\rBinomial (logistic) regression\r\rUses a logit link function so the response variable is the log odds\rEstimates are log odds and the probability of an event\r\rIntercept is log odds of first group\rEstimates for other groups are the ratio of log odds\rTransform from log odds to odds using exp()\r\r\rWhat is the function to conduct an Poisson regression in R?\nglm(Y ~ X, data, family = poisson)\rMelanoma tumor thickness and survival\rData is Melanoma from MASS. I have maniuplated the data so it is suitable for analysis - code below.\nMelanoma \u0026lt;- MASS::Melanoma\rMelanoma \u0026lt;- subset(Melanoma, Melanoma$status != 3) # remove observations of other causes of death\rMelanoma$status \u0026lt;- Melanoma$status - 1 # create binary variables: 0 = died, 1 = alive\r# binary regression\rmodel \u0026lt;- glm(status ~ thickness, Melanoma, family = binomial)\rsummary(model)\r\rCall:\rglm(formula = status ~ thickness, family = binomial, data = Melanoma)\rDeviance Residuals: Min 1Q Median 3Q Max -1.8588 -1.2162 0.6729 0.7485 1.8844 Coefficients:\rEstimate Std. Error z value Pr(\u0026gt;|z|) (Intercept) 1.61134 0.25496 6.320 2.62e-10 ***\rthickness -0.24853 0.06354 -3.911 9.18e-05 ***\r---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r(Dispersion parameter for binomial family taken to be 1)\rNull deviance: 232.84 on 190 degrees of freedom\rResidual deviance: 213.45 on 189 degrees of freedom\rAIC: 217.45\rNumber of Fisher Scoring iterations: 4\rplot(status ~ thickness, Melanoma, pch = 19) # plot\r# plot binomial regression in blue\rnewdat \u0026lt;- data.frame(thickness=seq(min(Melanoma$thickness), max(Melanoma$thickness),len=100))\rnewdat$status \u0026lt;- predict(model, newdata=newdat, type=\u0026quot;response\u0026quot;)\rlines(status ~ thickness, newdat, col=\u0026quot;blue\u0026quot;, lwd=2)\rIs there a relationship between Melanoma tumor thickness (mm) and whether a patient survives?\nYes. The thicker the tumour, the greater the odds of death. The P value of the slope of the binomial regression is significantly different from 0. P \u0026lt; 0.001.\rWhat does the coefficient estimate of -0.24853 for the variable thickness represent?\nThe estimate represents the log odds of survival as a function of tumour thickness. In other words, we expect the log odds of survival to decrease by 0.25 for a 1 mm increase in tumour thickness. We can transform log odds to odds by taking the exponential: exp(-0.24853) = 0.7799465. 1 - 0.7799465 = 0.22, so for every 1 mm increase in tumour thickness we expect the odds of survival to decrease by 22 %\rWhat is the probability of survival with a tumor 5 mm thick?\nThe logit formula is logit = p/(1-p) and the regression equation is logit(p) = 1.61134 - 0.24853 * thickness\rso logit(p) = 1.61134 - 0.24853 * 5 = 0.36869\rand to turn logit p into probability (p):\rp = exp(logit(p))/(1 + exp(logit(p)))\r= exp(0.36869)/(1 + exp(0.36869))\r= 0.5911424\rThe probability of surviving is 59 %\rWear suncreeen!\n\r\r\rTake home messages\r\rAlways check assumptions\rInterpret model in a biological context\r\rBiological data is messy: good model can have low R2\rOutliers aren’t always mistakes\rStatistical significance \\(\\neq\\) biological significance\r\rIs the model appropriate for the question?\rCan my experiment actually test my hypothesis?\rNever delete observations to force a better model fit or fit assumptions\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607968911,"objectID":"c71c608085059e4f9edb4f8baf69bd83","permalink":"https://jacintak.github.io/teaching/GLM/GLM3/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/GLM/GLM3/","section":"teaching","summary":"Overall lecture aims\r\rIdentify the structure of general linear models\rDescribe how linear models are parametrized\rUnderstand how to use linear models\rUnderstand how to interpret and evaluate linear models\r\rBy the end of this lecture you should:\r\rKnow how the coefficient of determination is calculated and its interpretation\rUnderstand the assumptions of linear regression\rBe able to evaluate the appropriateness of a linear model to data based on residual plots\rBe able to identify generalised linear models appropriate for data\rCreate residual plots in R\rConduct a generalised linear model in R\r\r\r\rBy now you should be comfortable with building and interpreting basic linear models in R\r\rbut how do we know whether our model is a “good” one?","tags":null,"title":"Generalised linear models","type":"docs"},{"authors":null,"categories":null,"content":"\r\r\rThis rmarkdown document contains some code for you to play with. You will need to copy and paste the code into your own R script (or Rmarkdown file). There are some questions for you to answer too. Click code to see the answers to the questions. Some questions don’t have answers but you should think about them.\nChecking that our data meets the assumption of linear models is pretty important. Else, we might make the wrong conclusion! Unfortunately, these checks may be ignored or forgotten about but that’s no excuse.\nHere are some things to look out for:\nNormality\rNormality can be checked using Quantile-Quantile plots.\nQuantile-Quantile (Q-Q) plots are useful alternatives to visualising distributions to density plots or histograms. They are easier to assess distribution and normality with than histograms.\nQ-Q plot of single variables\rWe can see whether a single variable has a normal distribution - specifically that the distribution is symmetrical or not skewed.\nqqnorm(chickwts$weight) # the weight of chicks fed different diets (built in dataset)\rHere, the quantiles of our observations are plotted against the theoretical quantiles if our observations followed a normal distribution.\nQuestion - What would you expect to see if our observations followed a normal distribution?\nObservations to fall along a straight line at approx a 45 degree angle\rWe can add a reference line to the above to help us evaluate how linear the Q-Q plot is. We can make the line red and thicker for fun.\nqqnorm(chickwts$weight) # the weight of chicks fed different diets (built in dataset)\rqqline(chickwts$weight, col = \u0026quot;red\u0026quot;, lwd = 2)\rDo the observations follow a normal distribution?\nCompare the above with the histogram and density plots\nplot(density(chickwts$weight), col = \u0026quot;purple\u0026quot;) # density plot, purple for fun\rhist(chickwts$weight, col = \u0026quot;yellow\u0026quot;) # histogram, yellow for fun\rWould you also conclude that the distribution of chick weights is normal?\nFor comparison look at the Q-Q plots of a gamma distribution (distinctly not normal)\nqqnorm(rgamma(100, 3, 5))\rqqline(rgamma(100, 3, 5)) # You should be able to see the skewness in the data. Compare with hist()\r\rWhat happens with data that is not continuous?\rQ-Q plots also work with visualising data that is not continuous.\nqqnorm(Loblolly$age) # the ages of pine trees, can also try rbinom(100, 10, 0.5)\rqqline(Loblolly$age)\rQuestion - What is the main difference between the Q-Q plots of the continuous and discrete data?\nYou can see the discrete nature of the observations in the clustered groupings in the QQ plot - the staircase pattern\rWhy do you think that is?\nYou can also see it using hist()\n\rQ-Q plots of residuals for assessing normality\rQ-Q plots permit comparison of two probability distributions when one distribution is the expected and the other is the observed distribution, then we can evaluate how well our observations follow our expected distribution. Using Q-Q plots we can assess skewness or identify outliers or influential points.\nQ-Q plots are automatically generated when calling plot on a linear model (lm). It’s the second graph called (defined using which). You can also make one using qqplot()\nplot(lm(Height ~ Girth, trees), which = 2)\rDoes that look normal to you?\n\rAnother use of Q-Q plots\rWe can also compare the distribution of two variables. If they are distributed equally then they should fall along the straight line\nqqplot(trees$Height, trees$Girth)\rCompare with:\npar(mfrow = c(2,1))\rhist(trees$Height)\rhist(trees$Girth)\r\r\rHomoscedasticity\rHomoscedasticity is the statistical term for homogeneity of variance. The opposite is called Heteroscedasticity.\nQuestion - What would you expect to see in a bar plot showing means and standard deviation for the assumption of homogeneity of variance to be met?\nWe want the variation across our grouped observations to be similar so the error bars of standard deviation should also be similar.\rLook at this graph - does it show homoscedasticity or heteroscedasticity?\r\rFigure 1: Bar plot of mean of two groups (A \u0026amp; B). Error bars indicate standard deviation\r\rHere, you can see that group B has a higher standard deviation than group A. So, we would conclude that there is heteroscedasticity. We do not want heteroscedasticity because it would bias the calculations of variance if we were to do an ANOVA. Remember that ANOVA is a test of variance.\nThe same concept applies for scatter plots. Look at this plot - does it show homoscedasticity or heteroscedasticity?\r\rFigure 2: A scatter plot and a fitted model\r\rHere, you can see that as the value of x increases so does the scatter around the trend line in y. It is sometimes referred to as a shotgun pattern or cone/triangle pattern. It’s common in time series data because your observations are not independent of each other, the value of one observation is dependent on what happens earlier in time. In other words, your response variable can be modelled based on the standard deviation.\nQuestion - What would you expect to see in a scatter plot for the assumption of homogeneity of variance to be met?\nWe want the variation across our grouped observations to be similar so the spread of observations along they axis (vertically) across the values of x (horizontally) should be similar.\rYou can assess this for a linear model from the (standardised or non-standardised) residual plot vs fitted values. Here’s the residual plot using the above data. Can you see the unequal variance?\nOne way of dealing with heteroscedasticity is to use weighted least squares regression where the parameters are fitted to a single observation based on its residual to correct for variation in the residuals (that scatter). But that is beyond the scope of this module.\n\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607968911,"objectID":"66f8b2c0c69b7e56f76435bb46a0f1cd","permalink":"https://jacintak.github.io/teaching/GLM/GLM4/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/GLM/GLM4/","section":"teaching","summary":"This rmarkdown document contains some code for you to play with. You will need to copy and paste the code into your own R script (or Rmarkdown file). There are some questions for you to answer too. Click code to see the answers to the questions. Some questions don’t have answers but you should think about them.\nChecking that our data meets the assumption of linear models is pretty important.","tags":null,"title":"Linear model assumptions","type":"docs"},{"authors":[],"categories":null,"content":"","date":1609506000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607888717,"objectID":"2877c41b350b5b6527267dde2925bc80","permalink":"https://jacintak.github.io/talk/IEA2021/","publishdate":"2020-12-13T00:00:00Z","relpermalink":"/talk/IEA2021/","section":"talk","summary":"I will be at IEA 2021","tags":["postdoc","conference","ectotherms","temperature"],"title":"IEA2021","type":"talk"},{"authors":null,"categories":null,"content":"\r\r\r\rInstallation\r1. List of palettes\r\rUnderstanding the structure of the palette\r\r2. Defining and using a palette\r3. Visualise a palette\rPalettes\rPalette by categories\r\rBirds\rFish\rFrogs\rInverts\rLandscapes\rLizards\rMammals\rPlants\rSnakes\rWarramaba grasshoppers\r\r\r\rcolRoz is a themed colour palette package by Jacinta Kong \u0026amp; Nicholas Wu.\nThe palettes are based on the colour schemes of Australia.\ncolRoz can:\n\rGenerate a palette of discrete colours of a specified number\rGenerate a gradient continuous colours of a specified number\r\rFor this, there are three functions described below. Before that, let’s set up this introduction.\nInstallation\rdevtools::install_github(\u0026quot;jacintak/colRoz\u0026quot;)\rcolRoz works with base R and ggplot2 because it is a palette generator and doesn’t have a built in ggplot palette function.\n\r1. List of palettes\rThe oz_palettes function contains the list of palettes available. Individual palettes are gouped by theme in a list. The oz_palettes variable is a list of these collated lists.\nnames(oz_palettes) # See all palette themes\r[1] \u0026quot;warramaba\u0026quot; \u0026quot;lizards\u0026quot; \u0026quot;landscapes\u0026quot; \u0026quot;birds\u0026quot; \u0026quot;frogs\u0026quot; [6] \u0026quot;snakes\u0026quot; \u0026quot;plants\u0026quot; \u0026quot;fish\u0026quot; \u0026quot;inverts\u0026quot; \u0026quot;mammals\u0026quot; names(oz_palettes$lizards) # See all lizard palettes\r[1] \u0026quot;c.decresii\u0026quot; \u0026quot;c.kingii\u0026quot; \u0026quot;e.leuraensis\u0026quot; \u0026quot;i.lesueurii\u0026quot; [5] \u0026quot;l.boydii\u0026quot; \u0026quot;m.horridus\u0026quot; \u0026quot;m.horridus2\u0026quot; \u0026quot;t.nigrolutea\u0026quot; [9] \u0026quot;v.acanthurus\u0026quot; \u0026quot;v.pilbarensis\u0026quot; \u0026quot;n.levis\u0026quot; \u0026quot;s.spinigerus\u0026quot; [13] \u0026quot;e.kingii\u0026quot; \rWe can call a specific list using subsetting rules for lists.\noz_palettes[[\u0026quot;warramaba\u0026quot;]][[\u0026quot;whitei\u0026quot;]] # Subset the palette for Warramaba whitei, format: [[theme list]][[palette list]]\r[,1] [,2] [,3] [,4] [,5] [,6] [1,] \u0026quot;#E5A430\u0026quot; \u0026quot;#9C7210\u0026quot; \u0026quot;#D7A8B8\u0026quot; \u0026quot;#BAB24F\u0026quot; \u0026quot;#392821\u0026quot; \u0026quot;#9B391B\u0026quot;\r[2,] \u0026quot;1\u0026quot; \u0026quot;3\u0026quot; \u0026quot;6\u0026quot; \u0026quot;5\u0026quot; \u0026quot;4\u0026quot; \u0026quot;2\u0026quot; oz_palettes$warramaba$whitei # does the same as above but using list names\r[,1] [,2] [,3] [,4] [,5] [,6] [1,] \u0026quot;#E5A430\u0026quot; \u0026quot;#9C7210\u0026quot; \u0026quot;#D7A8B8\u0026quot; \u0026quot;#BAB24F\u0026quot; \u0026quot;#392821\u0026quot; \u0026quot;#9B391B\u0026quot;\r[2,] \u0026quot;1\u0026quot; \u0026quot;3\u0026quot; \u0026quot;6\u0026quot; \u0026quot;5\u0026quot; \u0026quot;4\u0026quot; \u0026quot;2\u0026quot; \rUnderstanding the structure of the palette\rLists within lists may seem daunting but you’d rarely need to access the palettes individually. It is also easy enough to add your own palettes if you are comfortable with manually editing package functions in R.\nWe are happy to accept community contributions. Adding pre-chosen hex codes is easy to do. It may take longer to make a palette if we need to chose hex colours from an image.\nThe general structure for a set of palettes is:\npalette \u0026lt;- list(\rpal1 = rbind(c(\u0026lt;hex codes\u0026gt;), c(\u0026lt;order of discrete colours\u0026gt;))\r)\rTwo things to note:\n\rThe hex codes are stored as a vector in the first row of the list\rThe second row of the list is a vector of the order colours are used when plotting discrete colours\r\r\r\r2. Defining and using a palette\rThe palettes in this package are set as above. The main function is the palette generator. It acts as a housekeeping function to allow R to interpret the desired palette for plotting. The behaviour of this function depends on whether a discrete or continuous palette is desired and the number of colours requested.\nIf a discrete palette of 3 colours is desired, then the function will chose the subset of 3 colours to be included from the full option of colours in a palette. The chosen order of these colours is hard coded in the list of palette.\n\rNote there is no need to tell colRoz what theme the palette you want is in. Type in the palette name and colRoz will search the entire oz_palette list\n\rpal \u0026lt;- colRoz_pal(name = \u0026quot;ngadju\u0026quot;, n = 3, type = \u0026quot;discrete\u0026quot;)\r# a palette of only 3 colours\rlibrary(ggplot2)\rggplot(iris, aes(Petal.Width, Petal.Length , colour=Species)) +\rgeom_point() +\rscale_colour_manual(values = pal) +\rtheme_classic()\rIf a continuous palette is desired, then the function will use the function colorRampPalette in the grDevices package (included in R) to generate a gradient of colours between the first and last colour in the desired palette.\n\"continuous\" palettes are generated by default if the type argument is left blank. In ggplot2, use the function scale_colour_gradientn to set the continuous scale.\npal \u0026lt;- colRoz_pal(name = \u0026quot;ngadju\u0026quot;, n = 50, type = \u0026quot;continuous\u0026quot;)\rggplot(iris, aes(Petal.Width, Sepal.Length , colour=Petal.Length)) +\rgeom_point() +\rscale_colour_gradientn(colours = pal) +\rtheme_classic()\r***\n\r3. Visualise a palette\rThe function to plot the palette is only for graphing. Information is taken about the number of colours to plot from the desired palette and the palette is plotted. The name of the palette is shown.\nprint_palette(colRoz_pal(\u0026quot;c.decresii\u0026quot;))# if empty, all colours are shown\rprint_palette(colRoz_pal(\u0026quot;c.decresii\u0026quot;, type = \u0026quot;discrete\u0026quot;, n = 4))\rprint_palette(colRoz_pal(\u0026quot;c.decresii\u0026quot;, type = \u0026quot;continuous\u0026quot;, n = 30))\r\rPalettes\rcolRoz has a number of palettes sorted by categories:\n\rBirds\rFish\rFrogs\rInverts\rLandscapes\rLizards\rMammals\rPlants\rSnakes\rWarramaba grasshoppers\r\r\rPalette by categories\rBirds\rnames(oz_palettes$birds)\r[1] \u0026quot;p.cincta\u0026quot; \u0026quot;c.azureus\u0026quot; \u0026quot;m.cyaneus\u0026quot; \u0026quot;d.novae\u0026quot; \rBlack-throated finch. Australia’s 2019 Bird of the Year!\nAzure kingfisher photo by Brenton von Takach\nSuperb fairywren photo by Jessica McLachlan\nEmu\n\rFish\rnames(oz_palettes$fish)\r[1] \u0026quot;r.aculeatus\u0026quot;\rPicasso triggerfish photo by Brenton von Takach. Also called humuhumunukunukuapuaa in Hawaiian (see also the Octonauts episode)\n\rFrogs\rnames(oz_palettes$frogs)\rNULL\rThere are no frog palettes yet! Send us some and have your name here.\n\rInverts\rnames(oz_palettes$inverts)\r[1] \u0026quot;p.mitchelli\u0026quot; \u0026quot;k.tristis\u0026quot; \u0026quot;m.oscellata\u0026quot; \u0026quot;a.conica\u0026quot; [5] \u0026quot;v.viatica\u0026quot; \u0026quot;c.brevi\u0026quot; \u0026quot;a.westwoodi\u0026quot; \u0026quot;a.plagiata\u0026quot; [9] \u0026quot;physalia\u0026quot; \u0026quot;c.australasiae\u0026quot; \u0026quot;k.scurra\u0026quot; \u0026quot;l.vestiens\u0026quot; [13] \u0026quot;t.australis\u0026quot; \rMitchell’s diurnal cockroach photo by Craig White\nChameleon grasshopper photo by Kate Umbers\nGaudy acacia grasshopper\nGiant green slant-face\nMatchstick grasshopper, VIC. See Vandiemenella grasshoppers\nShort-tailed nudibranch, Port Philip Bay, VIC\nTortoise beetle\nTwo-spots tiger moth\nBluebottle. Undescribed species\nGreen grocer cicada\nKey’s matchstick grasshopper. See more info about K. scurra\nSea cucumber, intertidal VIC\nBiscuit star, Port Phillip Bay, VIC\n\rLandscapes\rnames(oz_palettes$landscapes)\r[1] \u0026quot;uluru\u0026quot; \u0026quot;shark_bay\u0026quot; \u0026quot;sky\u0026quot; \u0026quot;desert_sunset\u0026quot;\r[5] \u0026quot;desert_dusk\u0026quot; \u0026quot;desert_flood\u0026quot; \u0026quot;salt_lake\u0026quot; \u0026quot;daintree\u0026quot; [9] \u0026quot;spinifex\u0026quot; \u0026quot;nq_stream\u0026quot; \u0026quot;kimberley\u0026quot; \u0026quot;capricorn\u0026quot; \rPhoto from Jordan Iles\n\rLizards\rnames(oz_palettes$lizards)\r[1] \u0026quot;c.decresii\u0026quot; \u0026quot;c.kingii\u0026quot; \u0026quot;e.leuraensis\u0026quot; \u0026quot;i.lesueurii\u0026quot; [5] \u0026quot;l.boydii\u0026quot; \u0026quot;m.horridus\u0026quot; \u0026quot;m.horridus2\u0026quot; \u0026quot;t.nigrolutea\u0026quot; [9] \u0026quot;v.acanthurus\u0026quot; \u0026quot;v.pilbarensis\u0026quot; \u0026quot;n.levis\u0026quot; \u0026quot;s.spinigerus\u0026quot; [13] \u0026quot;e.kingii\u0026quot; \rTawny dragon\nBlue Mountains water skink\nThorny devil\nBlotched blue-tongued skink\nSouth-western spiny tailed gecko\nKing’s skink\nThree-lined knobtail gecko\nFrilled-neck lizard\nEastern water dragon\nBoyd’s forest dragon\nSpiny-tailed monitor\nPilbara rock monitor\n\rMammals\rnames(oz_palettes$mammals)\r[1] \u0026quot;p.breviceps\u0026quot; \u0026quot;thylacine\u0026quot; \rSugar glider\nThylacine (T. cynocephalus)\n\rPlants\rnames(oz_palettes$plants)\r[1] \u0026quot;n.violacea\u0026quot; \u0026quot;xantho\u0026quot; \rBlue lily photo by Emma Dalziell\nXanthorrhoea grasstree photo by Sarah Mulhall\n\rSnakes\rnames(oz_palettes$snakes)\r[1] \u0026quot;a.ramsayi\u0026quot;\rWoma python\n\rWarramaba grasshoppers\rThese are palettes based on the colours of matchstick grasshoppers in the genus Warramaba.\rYou can read more about matchstick grasshoppers on Jacinta’s website.\nThere are other matchstick grasshopper palettes in the inverts palette.\nnames(oz_palettes$warramaba)\r[1] \u0026quot;grandis\u0026quot; \u0026quot;flavolineata\u0026quot; \u0026quot;whitei\u0026quot; \u0026quot;picta\u0026quot; \u0026quot;virgo\u0026quot; [6] \u0026quot;ngadju\u0026quot; \r\r\r","date":1607904000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"efc2ba92f44ab8f85f859eea4a8d14cc","permalink":"https://jacintak.github.io/colRoz/","publishdate":"2020-12-14T00:00:00Z","relpermalink":"/colRoz/","section":"","summary":"Installation\r1. List of palettes\r\rUnderstanding the structure of the palette\r\r2. Defining and using a palette\r3. Visualise a palette\rPalettes\rPalette by categories\r\rBirds\rFish\rFrogs\rInverts\rLandscapes\rLizards\rMammals\rPlants\rSnakes\rWarramaba grasshoppers\r\r\r\rcolRoz is a themed colour palette package by Jacinta Kong \u0026amp; Nicholas Wu.\nThe palettes are based on the colour schemes of Australia.\ncolRoz can:","tags":["side-project"],"title":"colRoz - A colour package for the land down under","type":"page"},{"authors":[],"categories":[],"content":"\r\r\rWelcome to my revamped website!\rAfter banging my head against blogdown and Hugo on and off for several months (years), I think I understand enough about it to refresh my site. This has been my weekend coding hobby. It’s taken so long that the under-workings of Hugo and the Academic theme used here have changed in the meantime.\nSetting up a site is simple enough if you follow the instructions online. The template builds a skeleton of the website and all you need to do is replace the placeholder text with your information. Simple right?\nNot quite. The underlying file structure takes some getting used to and you’ll have to trust the magic as your site gets compiled. But once you pass that hurdle, the system is quite powerful and the results are neat.\nThere are many features to take advantage of. My interest was in having one site for code documentation and blogging as I was not satisfied with having a “regular” website (wordpress) with a blog and my code documentation separately on GitHub Pages.\nMy code documentation was also messing up my GitHub. I’m not a big fan of having documentation (e.g. a static website) lumped together with package files. I also didn’t like having an orphan branch for my documentation (no winners here). I can take advantage of the features of Hugo to move my static sites off their respective repositories and into one central one. It’s better this way as some of the static pages weren’t even relevant to the rest of the repo.\nFor example, I used the “Courses” feature to turn my lecture notes into a “tutorial” style page.\nThere are some features that are missing/not easily implemented compared to Wordpress that I will miss. You can’t comment or “follow” people, you can’t schedule posts and you can’t track views unless you set up Google Analytics or similar.\nI will keep the wordpress site up for now but will likely continue to update this one.\nThere are some peculiarities that require things to be done a certain way:\nThings I noted\r\rSometimes it’s a challenge to troubleshoot why things aren’t working they way you want. E.g. I couldn’t work out why the country wouldn’t show up in the document when including an address in YAML\rA header image/thumbnail can be included in the same folder as the content but it must be called “featured” or it won’t be recognised\rYou can have as many folders as you want called whatever but the (r)markdown file of the page must be called “index”\r\rIn the “Courses” feature the parent page must be called \"_index\" or it won’t work. 🤷\r\rRmd and the “Courses” feature don’t play nicely. Defining a table of contents via bookdown outputs in the YAML doesn’t work and calling toc: true directly in the YAML (follow the guide) doesn’t work either.\rbookdown and blogdown don’t play nicely together in the same project either. blogdown will try to render the bookdown pages as a site rather than letting bookdown do it’s thing and make a nice gitbook\remojis are a nice feature\r\r\r\r","date":1607904000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607984180,"objectID":"80ce68f768381e67e27ecd2d3c2de49e","permalink":"https://jacintak.github.io/post/2021-01-01-new-year-new-look/","publishdate":"2020-12-14T00:00:00Z","relpermalink":"/post/2021-01-01-new-year-new-look/","section":"post","summary":"Welcome to my revamped website!\rAfter banging my head against blogdown and Hugo on and off for several months (years), I think I understand enough about it to refresh my site. This has been my weekend coding hobby. It’s taken so long that the under-workings of Hugo and the Academic theme used here have changed in the meantime.\nSetting up a site is simple enough if you follow the instructions online.","tags":["website","github","R stats"],"title":"New Year, New Look!","type":"post"},{"authors":null,"categories":null,"content":"\r\r\rR/exams is an R package that generates a reproducible workflow for designing, producing and marking exams.\nHere, I provide a short walkthough for generating an online test for Blackboard - see the R/exams website for some tutorials.\nInstallation\rInstall R/exams via CRAN with install.packages(\"exams\").\n\rRunning the package for the first time\rexams uses rtools to create zip files. Make sure the proper rtools is installed. An error message will appear if rtools does not have permission to create zip files.\nTo give permission for creating .zip for windows:\rControl Panel \u0026gt; System and Security \u0026gt; System \u0026gt; Advanced System Settings \u0026gt; Environmental Variables \u0026gt; add “C:/RTools/bin”\nYou may also need to install dependent packages like tth for math notation.\n\rTypes of questions\r\rSingle correct answer MCQ (schoice)\rMultiple correct answer MCQ (mchoice)\rNumeric answer (num)\rString (string)\r\rCloze is another option but is not supported by blackboard, this permits a combination of the above for the MCQ answer list\n\rBuilding an exam question\rThere are several file types that are supported when writing your question but I have stuck with ‘.Rmd’. There are four parts of a question file:\nThe question\rThe answer list\rThe solution list for giving feedback\rThe meta-information\r\rEach of these sections are defined by a header tag marked by =====. # does not work as a tag.\nQuestion\rThe tag for defining the question is:\nQuestion\n========\nThe various random number generators in R will be your friend.\nsample() # pick n random number(s) from a vector of discrete numbers\rrunif() # generate a vector of continuous numbers, can set min and max\rrnorm() # generate a vector of continuous numbers from a normal distribution with a defined mean and standard deviation\rThings to note\r\rCode chunk options are in effect. By default figures will have captions, turn it of with fig.caption = \"\". Other useful figure options are figure sizes. Figure options can also be defined when compiling the exam\rYou can show code with echo = TRUE, turn off R formatting with results = \"asis\" \u0026amp; hide results with results = \"hide\"\rLaTeX formatting is fine in markdown and outside code chunks\rTo allow for randomised questions within a question file I had to escape the R code chunk to render the output as html, else the randomised question would be rendered as R output\rYou can generate a file to go with the question using any R write to file function. Include the file in the question as normal for Rmarkdown - [filename](filelink). Leave this as default or exams will not be able to find the file\r\r\r\rThe answer list\rThe answer subheading is defined by the tag:\nAnswer\n========\nBulleted markdown after this tag will be considered the options for an MCQ answer list.\nThings to note\r\rexams contains several helper functions to make it easy to generate lists of answers.\n\ranswerlist accepts a vector of answers. It also generates the answer subheading so there is no need to type it in.\rRecommend using html in case LaTeX does not render properly, particularly when called as a string in an R code chunk.\n\rDo not randomise the answer list here, use the metadata, else an incorrect answer will be assigned to be the correct one.\ncomment = NA in the code chunk options will remove the # from the R output.\n\rThere are also helper functions for various things. mchoice2string() turns the solutions vector above into binary responses for the meta-information section. num_to_choice generates a MCQ list of numbers for a numeric answer.\r\r\r\rSolution\rYou can provide feedback via the solution header, including which answers are correct\nSolution\n========\nYour solution here or correct answer: code for answer (or answer[])\nAnswerlist\n-———\n* True\n* False\n* etc.\n\rImportant There should be no spaces after the header tag title, i.e. markdown formatting\n\r\rQuestion metainformation\rThis is an important section of the question because it defines the correct answer. Metainformation is defined by the tag:\nMeta-information\n================\nUseful variables are:\n\rexname = title of question, becomes name of the pool in blackboard\rextype = type of question (num/schoice/mchoice)\rexsolution: order of correct answers in binary (e.g. 01010) for MCQ or R code for numeric output - e.g. \rextol = the tolerance range for numeric questions\rexshuffle = Whether to shuffle the answers or not. This can be used to randomly select a subset of answers from an answer list. Provide a number of answers for non-numeric questions (e.g. 4 for 4 answers). TRUE/FALSE is also accepted.\r\r\r\rAn example question\rThis example displays the correct answer and 3 randomly chosen option out of 6 possible answers.\nQuestion\r========\rWhat is your name?\r\\```{r question, results = \u0026quot;hide\u0026quot;, echo=F}\r# list of possible answer as a character vector\rknights_of_camelot \u0026lt;- c(\u0026quot;Arthur, King of the Britons\u0026quot;, \u0026quot;Sir Lancelot the Brave\u0026quot;,\r\u0026quot;Sir Robin the Not-Quite-So-Brave-as-Sir-Lancelot\u0026quot;,\r\u0026quot;Sir Galahad the Pure\u0026quot;,\r\u0026quot;Sir Bedevere the Wise\u0026quot;,\r\u0026quot;Patsy\u0026quot;)\r# solution to the vector above solutions \u0026lt;- c(FALSE, TRUE, FALSE, FALSE, FALSE, FALSE)\r# explanations (feedback for students)\rexplanations \u0026lt;- c(\u0026quot;I didn\u0026#39;t vote for him\u0026quot;,\r\u0026quot;His favourite colour is blue\u0026quot;,\r\u0026quot;He doesn\u0026#39;t know the capital of Assyria\u0026quot;,\r\u0026quot;His favourite colour is blue. No, yel...\u0026quot;,\r\u0026quot;Knows nothing about swallows\u0026quot;,\r\u0026quot;Clip Clop\u0026quot;)\r\\```\r\\```{r answerlist, echo=F, results = \u0026quot;asis\u0026quot;}\r# helper function to format the list of possible answers\ranswerlist(knights_of_camelot, markup = \u0026quot;markdown\u0026quot;)\r\\```\rSolution\r========\r\\```{r solutionlist, echo = FALSE, results = \u0026quot;asis\u0026quot;}\ranswerlist(ifelse(solultions, \u0026quot;True\u0026quot;, \u0026quot;False\u0026quot;), explanations, markup = \u0026quot;markdown\u0026quot;)\r\\```\rMeta-information\r================\rexname: Bridgekeeper\rextype: schoice\rexsolution: `\\r mchoice2string(solutions)`\rexshuffle: 4\r\rThis renders like this:\nExam 1\rQuestion\rWhat is your name?\rSir Bedevere the Wise\rArthur, King of the Britons\rSir Galahad the Pure\rSir Lancelot the Brave\rSolution\rFalse. Knows nothing about swallows\rFalse. I didn\u0026#39;t vote for him\rFalse. His favourite colour is blue. No, yel.\rTrue. His favourite colour is blue\rYou could also skip the solutions vector and include it in the explanations vector like c(\"False. I didn't vote for him\"). Of course, the solution does not appear immediately in blackboard but make sure the option for solutions and feedback to appear is checked.\n\rCompiling the exam\rI have written a script to compile the exam.\rThe compiling function (exams2blackboard) requires a list of file names to generate the exam. Each file represents a question. Versions of a question (n) generate a pool of questions. The list should not contain subdirectories or files not to be included in the exam. exams2html is a means of checking a file/list of exam questions renders properly in html (or exams2pdf).\nThere are several means of customising the metadata of the exam. Here I have:\n\rturned off partial marks - is TRUE by default\rused custom directories to search for the questions and save the output zip.\rset 10 copies for each question using the variable n\rset the name of the zip file using the variable name\rset the number of points for each question to 1, default = 10\r\rlibrary(\u0026quot;exams\u0026quot;)\roptions(device.ask.default = FALSE)\r## content and output directory\rmydir \u0026lt;- \u0026quot;C:/Users/kongj/OneDrive - TCDUD.onmicrosoft.com/Teaching/Biostats/Midsem MCQ\u0026quot;\r## define exam questions (each item in list is a pool)\rmyexam \u0026lt;- list.files(paste0(mydir,\u0026quot;/questions\u0026quot;), pattern = \u0026quot;.Rmd\u0026quot;)\r# render single question\r#exams2html(list(\u0026quot;question3.Rmd\u0026quot;), edir = paste0(mydir,\u0026quot;/questions\u0026quot;))\r## generate .zip with Blackboard exam with n replicates\rexams2blackboard(file = myexam, n = 10, name = \u0026#39;Jacinta\u0026#39;, dir = mydir,\redir = paste0(mydir,\u0026quot;/questions\u0026quot;),\reval = list(partial = FALSE, negative = FALSE),\rpoints = 1\r)\r\rThings to note\r\rYou can create a mix of questions in the exam by defining it in the list of questions but it is not recommended for generating pools of questions\rIf the exam is complied with no partial marks, then the blackboard exam will have no partial marks even if the option is checked within blackboard\rYou can generate a pool of questions by compiling a single question and uploading that zip file to Blackboard under “Import Pool”. This is useful for creating random block tests in Blackboard if the compiled zip file is not suitable as an test right away\r\r\r\r","date":1607904000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"5282367909d2d0b11aedadcd51872d29","permalink":"https://jacintak.github.io/teaching/rexams/","publishdate":"2020-12-14T00:00:00Z","relpermalink":"/teaching/rexams/","section":"teaching","summary":"Reproducible exams","tags":["teaching","R stats","code"],"title":"Quick guide to R/exams","type":"teaching"},{"authors":null,"categories":null,"content":"\r\r\r\rWelcome to Statistics and Computation for Biologists\rInstalling R and RStudio\r\rWindows\rMac\rLinux\rChromebook\r\rWhy R?\rWhy RStudio?\r\rRStudio scripts\r\rFile housekeeping\r\rWorking directories\r\rCreating a script\rLoading data\r\r.txt\r.csv\rCopying data\r\rTry it yourself\r\r\rChecking the data\r\rData structure\rSummarising data\r\rTips\rFinding help\rFinal checklist\r\rRecap quiz\r\rlearnr tutorials\r\r\rWelcome to Statistics and Computation for Biologists\rTraining to become a scientist can be broken down into two parts. First, there is content to learn - these are technical details or “how to” which come from textbooks, lectures or resources on the Internet.\nSecond, is learning how to define problems and how to solve them. This is true for statistics \u0026amp; computation. You can practice this in these drop in sessions and in your other modules. For example, R not working? Work out why, what’s wrong and what to change to make it work.\nIn this module we aim to give you the tools and knowledge to solve your own data science problems. These skills will be important in your later studies or even your career.\nUse the following checklist to make sure you are prepared for this semester:\n\rDo you have R and RStudio installed on your computer?\rIs your R up to date?\rDo you know how to set up scripts and directories in RStudio?\rAre your folders organised in a logical and sensible way?\r\rIf you’ve answered no to any of the above questions, then continue on. Some of you may already have R and RStudio installed from previous modules - that’s great! Check that your version and packages are all up to date (For packages - Under the Packages tab, click Update, For RStudio - Under Help menu at the top, click check for updates).\nRegardless, you should work through this handout to make sure you are comfortable with the basics of R. Use this as a reference throughout semester as we will be revisiting these concepts.\n\rInstalling R and RStudio\rR and RStudio are different software. R is a computer programming language and statistical environment. RStudio is a user interface which has some useful features that makes using R easier. If R is a retro text-based game (the ones where you chose your adventure with just words), then R studio is a graphic based game (like Legend of Zelda). It is possible to use R without RStudio but trust us, RStudio makes everything a lot easier by providing some organisation.\nYou will need to install R AND R studio in that order.\n\rHere’s a video about installing R https://vimeo.com/203516510 and RStudio https://vimeo.com/203516968\n\rYou can follow the instructions below or try the interactive tutorial at https://learnr-examples.shinyapps.io/ex-setup-r/#section-welcome\nHere are the instructions for various operating software:\nWindows\rFor R:\nGo to https://cran.r-project.org/bin/windows/base/\rClick “Download R” in the blue box. The version number is not important.\rSave the file, open it and follow the instructions. You can leave everything as the default option. Make sure you’ve installed the program somewhere sensible like the Programs folder in the C:/ drive.\rOpen it and check it installed properly\r\rFor RStudio:\nGo to https://rstudio.com/products/rstudio/download/\rClick download for RStudio Desktop Open Source Licence. The FREE option.\rInstall the program somewhere sensible\rOpen it and check it installed properly\r\r\rMac\rFor R:\nGo to https://cran.r-project.org/\rClick “Download R for (Mac) OS X”\rSave the latest release file (e.g. R-4.0.2.pkg), open it and follow the instructions. You can leave everything as the default option. Make sure you’ve installed the program somewhere sensible.\rOpen it and check it installed properly\r\rFor RStudio:\nGo to https://rstudio.com/products/rstudio/download/\rClick download for RStudio Desktop Open Source Licence. The FREE option.\rInstall the program somewhere sensible\rOpen it and check it installed properly\r\r\rLinux\rFor R:\nGo to https://cran.r-project.org/\rClick “Download R for Linux”\rClick your version of Linux\rCopy and paste the relevant installation code\rOpen R and check it installed properly\r\rFor RStudio:\nGo to https://rstudio.com/products/rstudio/download/\rClick download for RStudio Desktop Open Source Licence. The FREE option.\rRun the relevant code\rOpen it and check it installed properly\r\rSee https://linuxconfig.org/rstudio-on-ubuntu-18-04-bionic-beaver-linux for a guide\n\rChromebook\rThere are a few options:\n\rThe easiest option is to run Linux on your computer, then you can install R and RStudio. Try the instructions on https://blog.sellorm.com/2018/12/20/installing-r-and-rstudio-on-a-chromebook/ or https://github.com/jennybc/operation-chromebook#links-re-r-and-rstudio\rUse RStudio Server\rUse RStudio Cloud https://rstudio.cloud/ (in beta so it may not work)\r\rSorry chromebook users, if your chromebook version is very old then it may not be possible to install R.\n\r\rWhy R?\rR is just one of many programming languages but R is specially designed for doing statistics. Hence it is widely taught in statistic classes. There are other statistics programs (even Excel can do basic statistical tests) but these are normally “point-and-click” programs where you click a button and magic happens. The advantage of R is that it is an open source software where you can see how your data is being manipulated. Which means R is transparent, you can check whether the statistics is done correctly and is easier to see how statistical theory is being applied. It’s no longer magic but science.\n\rWhy RStudio?\rIf you open R itself you’ll see that it’s pretty bare bones. Most annoyingly you have to remember what information is stored in its memory. RStudio is a intermediate program that acts as a mediator between you and R:\nuser -\u0026gt; input -\u0026gt; RStudio -\u0026gt; R -\u0026gt; RStudio -\u0026gt; output -\u0026gt; user\nIf you open RStudio you’ll see several windows that organise how information is passed to R and how output from R is presented:\n\rLeft: The big window is the console. This is the interface with R and is the same as using R on its own. (don’t worry about “terminal”)\rTop right: This window has three tabs: “environment” - shows you what information is stored in R’s memory, “history” - shows your code history \u0026amp; “connections” - don’t worry about this one.\rBottom right: This has several tabs. The most important being “files” - showing you where RStudio is looking at on your computer \u0026amp; “plot” - shows you any plots you make in R.\r\rYou can customise the layout and colour scheme of RStudio in Options.\nThere are other user interfaces for R but RStudio has a lot of support.\nRStudio scripts\rThe greatest advantage of RStudio is that it allows you to write scripts. These are files ending in .R that are created and opened by RStudio. R itself cannot open, read or create scripts. Scripts are text documents of code that you can save on your computer and open later. They provide a guide to what you want to enter to R and saves you from having to type out code over and over again. Before RStudio, we had to save our code in notepad or similar then copy and paste it into R (believe me it was a pain). Now we can do the same but in one click. Importantly, scripts allow reproducibility and helps with problem solving.\nLet’s demonstrate the power of RStudio and scripts…but first an introduction to directories.\n\r\rFile housekeeping\rIt’s important for your computer files to be organised so that you can find your files later. Where possible don’t save your files to a “downloads” folder or your “desktop” - these should not be permanent file locations (OK for temporary ones).\nIn computer science, most operating software are organised in to drives, directories, folders \u0026amp; files. Using Windows as example:\rC:/ is a drive. Within the drive there are folders (e.g. Documents). Folders are groups of files (e.g. my_document.doc). Directories are the cataloguing system describing where files and folders are stored. Directories take the form of an address like “C:/documents/folder/file” which tells a program to look in this location.\n\rWe recommend that in your Documents folder you should have a folder for this module which contains folders for each of the practicals (5 folders). The practical folders should contain the relevant files for the practical. For example:\nDocuments (folder) -\u0026gt; Biostats (folder) -\u0026gt; Practical 1 (folder) -\u0026gt; Script (file)\n\rThe concept of folders and files comes from the days before computers where information was written on paper and stored in filing cabinets.\nDirectories are really important concepts in computer science. We use directories without realising it every time we use a computer.\nWorking directories\rRStudio works off directories. There is a default directory which shows up on the “Files” tab. This is called the Working Directory. You can change this by default under Tools -\u0026gt; Global Options but you can also change this temporarily under Session -\u0026gt; Set working directory.\nThis is the same as entering setwd(\u0026lt;insert directory address here\u0026gt;). It is good practice to keep similar files in the same folder. Otherwise you will need to specify the full address when you call a file that exists in another folder and it can get confusing if your files are all over the place (see below).\nYou can check what working directory R is using by typing getwd(). Note that if you run this from the console you might get a different answer because the default working directory of RStudio might be different to the working directory of a script. The working directory of a script is the folder the script is saved in.\nWhen we type directory addresses in R we can shorten the address used relative to the working directory. Otherwise we would have to type in the WHOLE address starting from the disk drive (usually C:/).\nFor example:\nIf my working directory was “C:/My Documents” and I had a file in my documents folder called “file.csv” that I wanted to load into R, then I do not need to type out “C:/My Documents/file.csv” but could use the short version “file.csv” because R automatically fills in the beginning of the address as it checks its working directory. Note directories are not case sensitive.\nC:\r-\u0026gt; my documents (within drive C - the working directory)\r-\u0026gt; file we want (within my documents)\rIf my working directory was “G:/Folder” and my file was in “C:/my documents”, then the short version “file.csv” would not work because R is using the address “G:/folder/file.csv”. And this address does not exist. It’s like writing the working directory first then adding on the short address after.\nC:\r-\u0026gt; my documents (within drive C)\r-\u0026gt; file we want (within my documents)\rG:\r-\u0026gt; folder (within drive G - the working directory)\r\rThink of directories and addresses like postal addresses - if your address is incorrect the postman (R) wouldn’t know where to go to pick up your parcel (file)\n\rSince addresses are relative, we can also get files stored in sub folders (folders within folders) separated by /. Note that R can understand / but does not understand \\ for computer reasons we do not need to get into. If you really need to use \\ in an address you need to type it twice - e.g. C:\\\\folder\\\\file. Note that if you copied the address of a directory directly from the address bar in Windows Explorer then it will use \\ so you need to replace them with /.\nC:\r-\u0026gt; my documents (within drive C - the working directory)\r-\u0026gt; folder (within my documents)\r-\u0026gt; file (within folder)\rFollowing the above example:\nIf my working directory was “C:/My Documents” and I had a file in a folder within my documents folder, then the full address is “C:/My Documents/folder/file.csv” and short address I could use in R is “folder/file.csv” because R is already looking in “C:/My Documents”. This works for any number of sub-folders within the same working directory.\nC:\r-\u0026gt; my documents (within drive C - the working directory)\r-\u0026gt; folder 1(within my documents)\r-\u0026gt; folder 2 (within folder 1)\r-\u0026gt; file (within folder 2)\rE.g. “folder1/folder2/folder3/file.csv” where folder 3 is within folder 2 which is within folder 1 which is within the working directory. But you wouldn’t have that many subfolders right?\nNow for a more complicated example.\rImagine we had a folder (parent folder) with two sub-folders A \u0026amp; B and we have set our working directory to folder A like this- setwd(\"C:/parent folder/folder A\"). BUT we wanted to access a file stored in folder B (called file.csv). Like so:\nC:\r-\u0026gt; parent folder (within drive C)\r-\u0026gt; folder A (within parent - the working directory)\r-\u0026gt; other files (within folder A)\r-\u0026gt; folder B (also within parent)\r-\u0026gt; file we want (within folder B)\rThe short address “folder B/file.csv” would NOT work because the address R is using is “C:/parent folder/folder A/folder B/file.csv” which does not exist - folder B is not within folder A.\nInstead we have two options:\nTo use the full address “C:/parent folder/folder B/file.csv”\rTo use the relative address and tell R to move up one directory before it starts looking for a file called “file.csv”. In computing, this is denoted ... So the short address becomes “../folder B/file.csv”. Use .. each time you want to go up a directory level.e.g. “../../../file” goes up three directory levels before looking for the file.\r\rThat’s about as complicated as it gets for working directories and if you can’t import data into R - check what the working directory in R is and what the address of the file is.\n\r\rCreating a script\rScripts are files of code that can be directly run in RStudio (.R files). You can create a new script under File -\u0026gt; New file -\u0026gt; Script (Ctrl+Shift+N) or click the white square with a green and white plus sign in the top left corner.\nSave it to your working directory and give it an informative name (e.g. “Dropin1”)\nLet’s add some code to this script by learning how to import data into R.\n\rRun code from your script rather than directly from the console, that way you have a record of what you’ve done and it makes it easy to spot any mistakes you might have made. Put your cursor on the line you want to run then press Ctrl+Enter or click Run.\n\r\rLoading data\rTo use data stored in other files, the data must be loaded or read into R. The function used to load data into R depends on the file type. Files names or directories are designated as character strings (\"\").\nThe function used to import data depends on the file type. read.delim() for deliminated data (hence delim) or read.csv() for csv files are two common ways. read.table() also works for tables. See help(\"read.table\") for the general inputs. The two most important inputs to be aware of are:\n\rheader: Use header = FALSE (default) if your data doesn’t have headers, header = TRUE to force R to recognise headers\rsep: Tells R to recognise how individual observations are separated (hence sep). sep = \"\" or sep = \" \" if it’s tab separated data (with white spaces between data - \"\" is a general indicator for any whitespace, \" \" is specifically 1 space) or sep = \",\" for comma separated values. If the data didn’t import properly it could be because the wrong read function or the wrong separator was used - try another one.\r\r.txt\rText files (.txt) tend to be delimited, meaning information is separated by a space of fixed width. e.g. 1 2 3 4 5 6 (separated by 1 space). This is loaded using read.delim(). Try loading the file “small_sleep.txt”:\nsmall_sleep \u0026lt;- read.delim(\u0026quot;small_sleep.txt\u0026quot;)\rsmall_sleep\rSpecies BodyWt TotalSleep\r1 Africanelephant 6654.000 3.3\r2 Africangiantpouchedrat 1.000 8.3\r3 ArcticFox 3.385 12.5\r4 Arcticgroundsquirrel 0.920 16.5\r5 Asianelephant 2547.000 3.9\r6 Baboon 10.550 9.8\r7 Bigbrownbat 0.023 19.7\r8 Braziliantapir 160.000 6.2\r9 Cat 3.300 14.5\r10 Chimpanzee 52.160 9.7\r\r.csv\rIf data is separated by a comma, it’s called a comma separated value file (.csv). e.g. 1,2,3,4,5,6. Note that .txt files can also be comma separated. The function to read csv is read.csv(). Try loading the file “mammal_sleep.csv”:\nmammal_sleep \u0026lt;- read.csv(\u0026quot;mammal_sleep.csv\u0026quot;)\r\rCopying data\rFor quick and dirty data entry, or for copying code from the Internet, you can load data from the clipboard after highlighting data and copying it. But it is always better to save a data file as a .csv file and importing into R so you always have a copy of the raw data you used.\nFor PC:\nmyclip_data \u0026lt;- read.csv(\u0026quot;clipboard\u0026quot;) # also works with read.delim\rFor Mac:\nmyclip_data \u0026lt;- read.csv(pipe(\u0026quot;pbpaste\u0026quot;)) # also works with read.delim\rWeb browsers might display whitespace differently so try a different separator depending on what web browser you are using.\nTry it yourself\rFor whichever operating system you have, highlight and copy this data and load this data into R using you new R script. Make sure you are using the correct read function:\n Species BodyWt\r1 Africanelephant 6654.000\r2 Africangiantpouchedrat 1.000\r3 ArcticFox 3.385\r4 Arcticgroundsquirrel 0.920\r5 Asianelephant 2547.000\r6 Baboon 10.550\r7 Bigbrownbat 0.023\r8 Braziliantapir 160.000\r9 Cat 3.300\r10 Chimpanzee 52.160\rSpecies,BodyWt,BrainWt,NonDreaming,Dreaming,TotalSleep,LifeSpan,Gestation,Predation,Exposure,Danger\rAfricanelephant,6654,5712,NA,NA,3.3,38.6,645,3,5,3\rAfricangiantpouchedrat,1,6.6,6.3,2,8.3,4.5,42,3,1,3\rArcticFox,3.385,44.5,NA,NA,12.5,14,60,1,1,1\rArcticgroundsquirrel,0.92,5.7,NA,NA,16.5,NA,25,5,2,3\rAsianelephant,2547,4603,2.1,1.8,3.9,69,624,3,5,4\rBaboon,10.55,179.5,9.1,0.7,9.8,27,180,4,4,4\rBigbrownbat,0.023,0.3,15.8,3.9,19.7,19,35,1,1,1\rBraziliantapir,160,169,5.2,1,6.2,30.4,392,4,5,4\rCat,3.3,25.6,10.9,3.6,14.5,28,63,1,2,1\n\r\r\rChecking the data\r\rAlways check that your data loaded properly. Sometimes strings are loaded as factors instead of characters or vice versa. Sometimes the columns are not recognised because the separator character is incorrect. There are always simple solutions to these problems (e.g. a small typo) and you should be able to fix them.\n\rFor bigger datasets it is easier to view a subset of the data or to use the View() function:\nhead(mammal_sleep, n = 6) # View the first 6 rows (6 is default, can be changed)\rSpecies BodyWt BrainWt NonDreaming Dreaming TotalSleep\r1 Africanelephant 6654.000 5712.0 NA NA 3.3\r2 Africangiantpouchedrat 1.000 6.6 6.3 2.0 8.3\r3 ArcticFox 3.385 44.5 NA NA 12.5\r4 Arcticgroundsquirrel 0.920 5.7 NA NA 16.5\r5 Asianelephant 2547.000 4603.0 2.1 1.8 3.9\r6 Baboon 10.550 179.5 9.1 0.7 9.8\rLifeSpan Gestation Predation Exposure Danger\r1 38.6 645 3 5 3\r2 4.5 42 3 1 3\r3 14.0 60 1 1 1\r4 NA 25 5 2 3\r5 69.0 624 3 5 4\r6 27.0 180 4 4 4\rView(mammal_sleep)\rData structure\rstr() is a handy function for checking the structure of your dataset. Let’s check the mammal sleep dataset.\nstr(mammal_sleep)\r\u0026#39;data.frame\u0026#39;: 62 obs. of 11 variables:\r$ Species : chr \u0026quot;Africanelephant\u0026quot; \u0026quot;Africangiantpouchedrat\u0026quot; \u0026quot;ArcticFox\u0026quot; \u0026quot;Arcticgroundsquirrel\u0026quot; ...\r$ BodyWt : num 6654 1 3.38 0.92 2547 ...\r$ BrainWt : num 5712 6.6 44.5 5.7 4603 ...\r$ NonDreaming: num NA 6.3 NA NA 2.1 9.1 15.8 5.2 10.9 8.3 ...\r$ Dreaming : num NA 2 NA NA 1.8 0.7 3.9 1 3.6 1.4 ...\r$ TotalSleep : num 3.3 8.3 12.5 16.5 3.9 9.8 19.7 6.2 14.5 9.7 ...\r$ LifeSpan : num 38.6 4.5 14 NA 69 27 19 30.4 28 50 ...\r$ Gestation : num 645 42 60 25 624 180 35 392 63 230 ...\r$ Predation : int 3 3 1 5 3 4 1 4 1 1 ...\r$ Exposure : int 5 1 1 2 5 4 1 5 2 1 ...\r$ Danger : int 3 3 1 3 4 4 1 4 1 1 ...\r\rThe first line tells us that mammal_sleep is a data frame. Which is how R stores observations in rows and columns. Other types are lists and matrices. It also tells us there are 62 observations - meaning the number of rows of data - and 11 variables - meaning the number of columns\rIn the first column of str(), are the names of the columns of the dataset listed with an $ are . So the first column is called Species\rThe second column shows what type of variable the data are: character (chr) for letters, numeric (num) for continuous numbers and integer (int) for discrete numbers. Another type you will encounter are Factors and levels - these are categorical variables.\rThe third column shows the first couple of observations in each column\r\r\rSummarising data\rsummary() shows some summary statistics for the specific variable\nsummary(mammal_sleep) # for all columns\rSpecies BodyWt BrainWt NonDreaming Length:62 Min. : 0.005 Min. : 0.14 Min. : 2.100 Class :character 1st Qu.: 0.600 1st Qu.: 4.25 1st Qu.: 6.250 Mode :character Median : 3.342 Median : 17.25 Median : 8.350 Mean : 198.790 Mean : 283.13 Mean : 8.673 3rd Qu.: 48.202 3rd Qu.: 166.00 3rd Qu.:11.000 Max. :6654.000 Max. :5712.00 Max. :17.900 NA\u0026#39;s :14 Dreaming TotalSleep LifeSpan Gestation Min. :0.000 Min. : 2.60 Min. : 2.000 Min. : 12.00 1st Qu.:0.900 1st Qu.: 8.05 1st Qu.: 6.625 1st Qu.: 35.75 Median :1.800 Median :10.45 Median : 15.100 Median : 79.00 Mean :1.972 Mean :10.53 Mean : 19.878 Mean :142.35 3rd Qu.:2.550 3rd Qu.:13.20 3rd Qu.: 27.750 3rd Qu.:207.50 Max. :6.600 Max. :19.90 Max. :100.000 Max. :645.00 NA\u0026#39;s :12 NA\u0026#39;s :4 NA\u0026#39;s :4 NA\u0026#39;s :4 Predation Exposure Danger Min. :1.000 Min. :1.000 Min. :1.000 1st Qu.:2.000 1st Qu.:1.000 1st Qu.:1.000 Median :3.000 Median :2.000 Median :2.000 Mean :2.871 Mean :2.419 Mean :2.613 3rd Qu.:4.000 3rd Qu.:4.000 3rd Qu.:4.000 Max. :5.000 Max. :5.000 Max. :5.000 summary(mammal_sleep$BodyWt) # summary statistics for body weight\rMin. 1st Qu. Median Mean 3rd Qu. Max. 0.005 0.600 3.342 198.790 48.202 6654.000 \r\r\rTips\r\rCoding is like learning a language. There is grammar, syntax and terminology to learn.\rThe secret to being a coding whiz is practice, practice, practice. Try using R at every opportunity. If you don’t use it, you lose it.\rIt’s OK to google everything. No matter how many years you’ve been using R you will forget something basic.\rA lot of programming is logic. If you can’t describe what you want to achieve in words, then you can’t code it. Sometimes the solution means changing your way of thinking about a problem.\rA lot of errors come from spelling or syntax mistakes. It doesn’t mean you don’t know it, check your code carefully for typos. Missing brackets or quotation marks are common mistakes.\rOften, copying and pasting your error message into google comes up with the solution\rTrial and error is a big part of programming. If it doesn’t work the first time, tweak it and try it again. Getting a function to work might be as simple as adding or removing one of the defined parameters.\r\r\rFinding help\rAll R code comes with help files. You can access them from the “Help” tab in RStudio. If you want help on a specific function, then you can type in help(\u0026lt;insert function name here\u0026gt;). If you don’t know your exact query, you can search using ??\u0026lt;insert term here\u0026gt; - e.g. ??mean.\nThe Internet is really really great for R help. Websites like StackExchange are help forums for programming. Most likely your question has already been answered on StackExchange. The trick is knowing what to type into Google.\nLearning to problem solve independently is not something you learn by reading or something you can be taught. It is a skill you have to learn by doing, which means having a go yourself before seeking help from others. Make asking for help your last option. You’ll see on StackExchange people describe what they want to achieve, what they have done so far, identified what the problem is and provide some reproducible code to help someone else understand their problem. It’s really hard to fix someone’s coding problem without context.\n\rFinal checklist\r\rHave you installed R?\rHave you installed RStudio?\rAre all your versions and packages up to date?\rDo you know how to create and save an R script?\rDo you know how to set your working directory?\rCan you import data into R?\rCan you run a line of code?\rCan you use a function?\r\rRecap quiz\rWhat is the working directory in computing?\nWorking directories are the location (folder) on your computer that the program is looking in by default. All file address are relative to the working directory\rWhat is the difference between the function getwd() and setwd()?\ngetwd() tells you what R thinks the working directory is, setwd() tells R what you want the working directory to be\r\r\rlearnr tutorials\rIn addition to the Drop ins, the lectures and the practicals, there are optional tutorials about stats that you can run directly from RStudio in your own time. They are there to supplement your learning.\nYou can install these tutorials by following the instructions here.\n\r","date":1607904000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"726db3bf28a75be1a7b405a79c489e25","permalink":"https://jacintak.github.io/teaching/introR/","publishdate":"2020-12-14T00:00:00Z","relpermalink":"/teaching/introR/","section":"teaching","summary":"Download and set up R and RStudio","tags":["teaching","R stats","code"],"title":"Setup R","type":"teaching"},{"authors":[],"categories":["code"],"content":"\r\r\rI’m not usually a dark background person but I’m open to the dark side. I wanted to make a solid coloured graph with a transparent background that would show up nicely but ggplot2 doesn’t have a set theme for that. A clean solid fill and transparency requires some specific customisation so here is a reproducible example for you using the built-in trees dataset:\ntree_graph \u0026lt;- ggplot(data = trees, mapping = aes(x = Height, y = Girth)) + geom_point(size = 0.5, colour = \u0026quot;#B8DE29FF\u0026quot;) + geom_smooth(method = \u0026quot;lm\u0026quot;, se = FALSE, col = \u0026quot;#B8DE29FF\u0026quot;) + geom_abline(intercept = 0, slope = 1, col = \u0026quot;white\u0026quot;, lwd = 0.5, lty = 2) + theme_classic() +\rtheme(plot.background = element_rect(fill = \u0026quot;transparent\u0026quot;, color = NA),\rpanel.background = element_rect(fill = \u0026quot;transparent\u0026quot;),\raxis.text = element_text(colour = \u0026quot;#B8DE29FF\u0026quot;, size = 8),\raxis.title = element_text(colour = \u0026quot;#B8DE29FF\u0026quot;, size = 8),\raxis.line = element_line(colour = \u0026quot;#B8DE29FF\u0026quot;),\raxis.ticks = element_line(colour = \u0026quot;#B8DE29FF\u0026quot;))\rggsave(tree_graph, filename = \u0026quot;tree_graph.png\u0026quot;, bg = \u0026quot;transparent\u0026quot;, type = \u0026quot;cairo-png\u0026quot;)\rThere are a couple of generally useful elements added on purpose:\n\rgeom_smooth creates an automatically fitted linear model (defined using method = \"lm\"). I have turned off plotting the standard errors (on by default) and manually set the colour.\rgeom_abline is your standard straight line\rtheme is where the customisation begins:\r\rplot.background \u0026amp; panel.background are set to transparent\rThe various axis elements are set to the fill colour (a nice viridis green) and desired text size\r\rggsave specifies that the background is transparent and to save it as a “cairo-png”. Cairo is needed to create a vector based image so resizing the png isn’t an issue since the small font size is already defined\r\rIf you don’t save it as a Cairo png, then the text will still have a white outline and won’t be a clean solid fill\r\r\r","date":1607904000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607984180,"objectID":"e80560e44a41352d9e8728aa019b175e","permalink":"https://jacintak.github.io/post/2020-12-14-transparent-graphing-for-dark-backgrounds/","publishdate":"2020-12-14T00:00:00Z","relpermalink":"/post/2020-12-14-transparent-graphing-for-dark-backgrounds/","section":"post","summary":"I’m not usually a dark background person but I’m open to the dark side. I wanted to make a solid coloured graph with a transparent background that would show up nicely but ggplot2 doesn’t have a set theme for that. A clean solid fill and transparency requires some specific customisation so here is a reproducible example for you using the built-in trees dataset:\ntree_graph \u0026lt;- ggplot(data = trees, mapping = aes(x = Height, y = Girth)) + geom_point(size = 0.","tags":["code","conferences","talks","poster","R stats"],"title":"Transparent graphing for dark backgrounds","type":"post"},{"authors":["Jacinta Kong","Jason K. Axford","Ary A. Hoffmann","Michael R. Kearney"],"categories":null,"content":"Abstract Insect life cycles are adapted to a seasonal climate by expressing alternative voltinism phenotypes—the number of generations in a year. Variation in voltinism phenotypes along latitudinal gradients may be generated by developmental traits at critical life stages, such as eggs. Both voltinism and egg development are thermally determined traits, yet independently derived models of voltinism and thermal adaptation refer to the evolution of dormancy and thermal sensitivity of development rate, respectively, as independent influences on life history. To reconcile these models and test their respective predictions, we characterized patterns of voltinism and thermal response of egg development rate along a latitudinal temperature gradient using the matchstick grasshopper genus Warramaba. We found remarkably strong variation in voltinism patterns, as well as corresponding egg dormancy patterns and thermal responses of egg development. Our results show that the switch in voltinism along the latitudinal gradient was explained by the combined predictions of the evolution of voltinism and of thermal adaptation. We suggest that latitudinal patterns in thermal responses and corresponding life histories need to consider the evolution of thermal response curves within the context of seasonal temperature cycles rather than based solely on optimality and trade-offs in performance. This article is part of the theme issue ‘Physiological diversity, biodiversity patterns and global climate change: testing key hypotheses involving temperature and oxygen’.\n","date":1548892800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607880692,"objectID":"42bd2b0f81290fb0ceae73a15db1c4ff","permalink":"https://jacintak.github.io/publication/2019-PTRSB/","publishdate":"2019-01-31T00:00:00Z","relpermalink":"/publication/2019-PTRSB/","section":"publication","summary":"Abstract Insect life cycles are adapted to a seasonal climate by expressing alternative voltinism phenotypes—the number of generations in a year. Variation in voltinism phenotypes along latitudinal gradients may be generated by developmental traits at critical life stages, such as eggs. Both voltinism and egg development are thermally determined traits, yet independently derived models of voltinism and thermal adaptation refer to the evolution of dormancy and thermal sensitivity of development rate, respectively, as independent influences on life history.","tags":["ectotherms","thermal adaptation","thermal response","life history"],"title":"Linking thermal adaptation and life-history theory explains latitudinal patterns of voltinism","type":"publication"},{"authors":["Michael R. Kearney","John Deutscher","Jacinta Kong","Ary A. Hoffmann"],"categories":null,"content":"Abstract The phenological response is among the most important traits affecting a species' sensitivity to climate. In insects, strongly seasonal environments often select for a univoltine life-cycle such that one seasonal extreme is avoided as an inactive stage. Through understanding the underlying mechanisms for univoltinism, and the consequences of its failure, we can better predict insect responses to climate change. Here we combine empirical data and simulation studies to investigate the consequences of an unusual diapause mechanism in a parthenogenetic matchstick grasshopper, Warramaba virgo, from arid southern Australia. Our field body temperature measurements indicate that this species is a thermoconformer and our laboratory studies of the thermal response of feeding rate imply strong constraints on winter activity. However, the species exhibits no obligate winter diapause, and eggs can develop in one month under constant temperatures approximating the mean soil temperature at the time of oviposition (summer). We show that diurnal temperature cycles exceeding a peak of 36 degrees C inhibit egg development in summer, and that this is sufficient to prevent autumnal hatching of eggs. Development is also strongly retarded below 24 degrees C. Microclimate-driven simulation studies of egg development show that these thermal responses provide robust maintenance of a univoltine life cycle, thereby resulting in survival of heat stress as an egg (due to limited developmental state) and avoidance of cold stress as a nymph and adult (due to overwintering in the soil as an egg). This article is protected by copyright. All rights reserved.\n","date":1520899200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607984180,"objectID":"31372bb950c3acadf4ead569bb0179e8","permalink":"https://jacintak.github.io/publication/2018-inte-zool/","publishdate":"2018-03-13T00:00:00Z","relpermalink":"/publication/2018-inte-zool/","section":"publication","summary":"Abstract The phenological response is among the most important traits affecting a species' sensitivity to climate. In insects, strongly seasonal environments often select for a univoltine life-cycle such that one seasonal extreme is avoided as an inactive stage. Through understanding the underlying mechanisms for univoltinism, and the consequences of its failure, we can better predict insect responses to climate change. Here we combine empirical data and simulation studies to investigate the consequences of an unusual diapause mechanism in a parthenogenetic matchstick grasshopper, Warramaba virgo, from arid southern Australia.","tags":["ectotherms","thermal adaptation","life cycles","microclimate","mechanistic models"],"title":"Summer egg diapause in a matchstick grasshopper synchronises the life cycle and buffers thermal extremes","type":"publication"},{"authors":["James L. Maino","Jacinta Kong","Ary A. Hoffmann","Madeleine G. Barton","Michael R. Kearney."],"categories":null,"content":"Abstract Mechanistic models of the impacts of climate change on insects can be seen as very specific hypotheses about the connections between microclimate, ecophysiology and vital rates. These models must adequately capture stage-specific responses, carry-over effects between successive stages, and the evolutionary potential of the functional traits involved in complex insect life-cycles. Here we highlight key considerations for current approaches to mechanistic modelling of insect responses to climate change. We illustrate these considerations within a general mechanistic framework incorporating the thermodynamic linkages between microclimate and heat, water and nutrient exchange throughout the life-cycle under different climate scenarios. We emphasise how such a holistic perspective will provide increasingly robust insights into how insects adapt and respond to changing climates.\n","date":1476144000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607984180,"objectID":"3d90d66f6179b68b1be5bd8594f7add1","permalink":"https://jacintak.github.io/publication/2016-COIS/","publishdate":"2016-10-11T00:00:00Z","relpermalink":"/publication/2016-COIS/","section":"publication","summary":"Abstract Mechanistic models of the impacts of climate change on insects can be seen as very specific hypotheses about the connections between microclimate, ecophysiology and vital rates. These models must adequately capture stage-specific responses, carry-over effects between successive stages, and the evolutionary potential of the functional traits involved in complex insect life-cycles. Here we highlight key considerations for current approaches to mechanistic modelling of insect responses to climate change. We illustrate these considerations within a general mechanistic framework incorporating the thermodynamic linkages between microclimate and heat, water and nutrient exchange throughout the life-cycle under different climate scenarios.","tags":["ectotherms","thermal adaptation","life cycles","microclimate","mechanistic models"],"title":"Mechanistic models for predicting insect responses to climate change","type":"publication"},{"authors":["Jacinta Kong","Jason K. Axford","Ary A. Hoffmann","Michael R. Kearney"],"categories":null,"content":"Abstract   High-throughput genomic methods are increasingly used to investigate invertebrate thermal responses with greater dimensionality and resolution than previously achieved. However, corresponding methods for characterizing invertebrate phenotypes are still lacking. To scale up the characterization of invertebrate thermal responses, we propose a novel use of thermocyclers as temperature-controlled incubators.\n  Here, we tested the performance of thermocyclers as incubators and demonstrated the application of this method to efficiently characterize the thermal responses of model and non-model invertebrates.\n  We found the thermocyclers performed with high precision, accuracy and resolution under various and fluctuating ambient conditions. We were able to successfully characterize the temperature-dependent development of grasshopper eggs (Warramaba virgo), as well as the effects of fluctuating temperature cycles on the survival of mosquito eggs (Aedes aegypti) and developmental success of Drosophila simulans larvae, all with similar survival rates to conventional methods.\n  Thermocyclers are a general and transferrable means to scale up current methods of incubating small invertebrates. They permit rapid characterization of high-dimensional physiological responses to natural thermal regimes. When combined with existing approaches in thermal and evolutionary biology, these methods will advance our understanding of, and ability to predict, biological adaptations and responses to environmental changes.\n  ","date":1462924800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607880692,"objectID":"51c065cdd0243c50c8f0d0926b444014","permalink":"https://jacintak.github.io/publication/2016-MEE/","publishdate":"2016-05-11T00:00:00Z","relpermalink":"/publication/2016-MEE/","section":"publication","summary":"Abstract   High-throughput genomic methods are increasingly used to investigate invertebrate thermal responses with greater dimensionality and resolution than previously achieved. However, corresponding methods for characterizing invertebrate phenotypes are still lacking. To scale up the characterization of invertebrate thermal responses, we propose a novel use of thermocyclers as temperature-controlled incubators.\n  Here, we tested the performance of thermocyclers as incubators and demonstrated the application of this method to efficiently characterize the thermal responses of model and non-model invertebrates.","tags":["ectotherms","thermal adaptation","thermal response"],"title":"Novel applications of thermocyclers for phenotyping invertebrate thermal responses","type":"publication"},{"authors":null,"categories":null,"content":"\r\r\r\rTools for forcasting or predicting\rResources for forcasting\r\rMacroclimate\rMicroclimate\rMicroclimate simulation packages for R\r\rThings to consider\r\rTraits\r\rR packages for modelling\r\rNicheMapR, DEB \u0026amp; biophysical ecology\r\rInternational Symposium and Thematic School on DEB Theory for Metabolic Organisation\r\r\rTools for forcasting or predicting\rI am interested in developing a toolbox for biologists to make trait-based predictions or forecasts about how ectotherms respond to environmental change that are grounded in theory. Fostering stronger links between our understanding of terrestrial ectotherm thermal biology and the aquatic realm is important to identify general patterns.\n\rResources for forcasting\rA good model needs good input data!\nA pretty important component of modelling species responses to environmental variables are the environmental variables themselves. In fact, it’s already half the data. Ideally, you would have climatic data at the scale of the target organism, which I will generally refer to as microclimate, but this is often a challenge to acquire. But if you have access to climate data, e.g. gridded weather stations which I will refer to as macroclimate, then there are some solutions for generating microclimate data.\nMost experimental biologists will have access to plenty of data on organism traits but may not have the right environmental data for a model. The good news is with the increasing ease of generating and storing big data, data is now more accessible than ever before!\nMacroclimate\rIf you don’t have access to gridded weather station data for your area of interest, there are some publicly available datasets online for various environmental variables at various scales and resolutions:\n\rWorldClim\rCliMond with CLIMEX and Bioclim datasets\rClimatic Research Unit\r\r\rMicroclimate\rThere are currently a few publicly available datasets of pre-calculated microclimate grids. All these examples were made using NicheMapR:\n\rmicrolim for global scale\rMicroclimOz for Australia only (the lucky country)\rMicroclimUS for USA\r\r\rMicroclimate simulation packages for R\rThere are a few packages for R to simulate microclimates from gridded macroclimate data:\n\rNicheMapR\rMicroclima\rTrenchR\r\rThe one I used in my work is NicheMapR. The default function to generate microclimate in NicheMapR uses the Climatic Research Unit dataset to generate default microclimate output. I used input data at a higher spatial and temporal resolution than the default setting, in addition to querying gridded soil type data. Although the input data to run my scripts is not available, NicheMapR was used to generate the microclim and MicroclimOz datasets which are publicly available under certain soil type parameters.\nThings to consider\rCheck if the environmental datasets are at the resolution and scale appropriate for your intended purposes. If you want to simulate microclimate, you need to make sure you have all the environmental variables needed for the microclimate package: temperature, precipitation, soil type, topography, wind speed, solar radiation etc. You may have to collate input data from multiple sources.\n\r\rTraits\rThere are even a few databases for organism trait data:\n\rThe Insect Developmental Database (IDD) contains temperature-rate data for mostly insect species of agricultural interest\rFor physiological limits GlobTherm is a great initiative but covers CtMax and CtMin only.\rA few recent metaanalyses have combed through the thermal biology literature so you don’t have to! Then you can extract the information you want. Isn’t open, reproducible science great? Here’s a recent example\rDell et al. 2013 complied a dataset on various biological/ecological traits measured at different tempertures for species from all habitats.\r\r\r\rR packages for modelling\rIn my PhD I wrote a custom function for my code to calculate development rate. But there is also a package for that!\ndevRate is a package with commonly used temperature-rate functions, from statistical functions to biophysical ones. You can get it from CRAN.\nThere is a similar package called rTPC. It’s not on CRAN but is available on GitHub.\nNicheMapR, DEB \u0026amp; biophysical ecology\rFortunately, the NicheMapR package is a pretty complete toolkit to model the biology of an organism based on its environment and available resources. Not only does it have a microclimate model but it also has an implementation of the standard DEB model and a biophysical heat and water budget model for ecotherms and endotherms. All that is missing are the correct input parameters.\nHeat and/or water budget equations are useful for calculating the body temperature of an organism but don’t measure growth or development. You could use the estimates of body temperture for calculating development/growth rates but for most small ectotherms that are isothermic, this seems a bit excessive.\nDEB parameters and Add-My-Pet\rYou can find standard DEB parameters at Add-My-Pet and there is a vignette in NicheMapR which goes through the ectotherm model, the DEB model and how to use the DEB parameters from Add-My-Pet in NicheMapR.\n\r\r\rInternational Symposium and Thematic School on DEB Theory for Metabolic Organisation\rInterested in learning Dynamic Energy Budget modelling? There is an international symposium, tele-course and school/workshop that is an intensive course in DEB and its applications. The symposium is held every two years. The most recent one was April 2019.\nWith the resources available you can pretty much develop a mechanistic model without collecting your own data.\nIf there are other useful datasets or links not listed here, let me know!\n\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"22846843e25e77b108339fefcfafa8e4","permalink":"https://jacintak.github.io/project/toolbox/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/project/toolbox/","section":"project","summary":"Forecasting the environmental physiology of ectotherms","tags":["ectotherms"],"title":"A toolbox for trait-based forecasting","type":"project"},{"authors":null,"categories":null,"content":"Introduction biostats.tutorials is an R package of learnr tutorials for introductory biostatistics and R.\nSet up We need to set up our computer to start using tutorials in R.\nFollow this checklist in order to make sure you are set up:\n Have you installed R version 4.0 or above? - if not, install/update R  You can check your R package version using R.version()$version.string   Have you installed RStudio version 1.0.136 or above? - if not install/update RStudio  You can check your RStudio version using RStudio.Version()$version   Have you installed the following packages? - if not use install.packages() to do so  learnr - needed to run the tutorials remotes (or devtools) - needed to install the tutorials knitr - for displaying content    If everything works then you should see a Tutorials tab in one of your RStudio windows (perhaps next to Environment and History)\n Installing the tutorials Now we need to install the tutorial. The tutorials are stored in a Package available on GitHub. You will only have to install the package once at the beginning.\nUse the following code:\nremotes::install_github(\u0026quot;jacintak/biostats\u0026quot;, dependencies = TRUE)\rIf you are asked to install any other packages, choose yes but don\u0026rsquo;t do any compiling (press no if asked).\nIf the package installed properly, you should automatically see the tutorials in the Tutorial tab.\n Running a tutorial You should be able to run a tutorial from the Tutorial tab when you open RStudio without needing to do anything.\nMake sure it\u0026rsquo;s a tutorial from the biostats.tutorials package.\nIf you click run tutorial, the tutorial will show up in the tab. You can click the \u0026ldquo;Show in new window\u0026rdquo; icon to open it in another window. Press the \u0026ldquo;Home\u0026rdquo; icon to return to the Tutorials tab.\nIf that doesn\u0026rsquo;t work use this code and the tutorial will open in another window:\nlearnr::run_tutorial(\u0026quot;\u0026lt;insert name of the tutorial to run\u0026gt;\u0026quot;, package = \u0026quot;biostats.tutorials\u0026quot;)\rIf neither works, check that the biostats.tutorials package installed properly.\nQuit a tutorial by pressing the \u0026ldquo;Stop\u0026rdquo; icon.\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"190236a324d12c23a2a15f29f155ef24","permalink":"https://jacintak.github.io/project/biostats-tutorials/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/project/biostats-tutorials/","section":"project","summary":"learnr tutorials for teaching undergraduate biostatistics","tags":["teaching","R stats","code"],"title":"Biostatistics tutorials","type":"project"},{"authors":null,"categories":null,"content":"\r\r\rColRoz\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607908220,"objectID":"915eb24acd339dfbfc5b9325f0743bea","permalink":"https://jacintak.github.io/project/colRoz/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/project/colRoz/","section":"project","summary":"A colour package for the land down under","tags":["side-project"],"title":"colRoz","type":"project"},{"authors":null,"categories":null,"content":"\r\r\r\rResearch and teaching appointments\rQualifications\rRefereed journal articles\rResearch highlights\rResearch grants or awards\r\rOther Awards and Scholarships\r\rTeaching contributions and course development\rConference presentations and invited talks\rProfessional service and affiliations\rCommunity outreach and communication\r\r\rResearch and teaching appointments\r\rTeaching and Research Fellow\nDepartment of Zoology, School of Natural Sciences.\nTrinity College Dublin, Dublin, Ireland\n5.2019 – Present\rResearch Assistant\nIntraspecific variation in mechanistic species distribution modelling,\nThe University of Melbourne, Australia\n5.2018 – 12.2018\rComparative Animal Physiology tutor (Second Year undergraduate)\nSchool of BioSciences, the University of Melbourne, Australia\n2017– 2018\rEcology in Changing Environments tutor (Third Year undergraduate)\nSchool of BioSciences, the University of Melbourne, Australia\n2016– 2018\rComparative Animal Physiology residential tutor,\nUniversity College, the University of Melbourne, Australia\n2017– 2018\rFirst Year Chemistry residential tutor\nSt John’s College, the University of Queensland Australia\n8.2014 – 10.2014\rFirst Year Biology tutor (Science Learning Centre tutor),\nthe Faculty of Science, the University of Queensland, Australia\n2012\rPeer Assisted Study Session leader: first year statistics\nThe Peer Assisted Study Session office and the School of Mathematics and Physics, the University of Queensland Australia\n8.2012 – 10.2012\rPeer Assisted Study Session leader: first year ecology\nThe Peer Assisted Study Session office, the University of Queensland Australia\n2011 – 2012\rVolunteer laboratory technician. Animal husbandry.\nWhite Evolutionary Physiology Laboratory, the University of Queensland\n3.2012 – 10.2012\r\r\rQualifications\rDoctor of Philosophy (Science)\nThe University of Melbourne, Australia\nTitle: Predicting ectotherm life cycles under a variable climate: Physiological diversity of matchstick grasshopper eggs and their ecological and evolutionary implications\n1.2015 – completed 14 Aug 2019, conferred 5.10.2020\nBachelor of Science (Honours Class I, University Medal)\nThe University of Queensland, Australia\nTitle: The effect of temperature on the relationship between metabolic rate and mass: Tests of the Metabolic Theory of Ecology\nConferred 6.12.2013\nBachelor of Science\rThe University of Queensland, Australia\nConferred 17.12.2012\n\rRefereed journal articles\r\rSee Publications\n\r\rKong JD, Hoffmann AA, Kearney MR. (2019) Linking thermal adaptation and life-history theory explains latitudinal patterns of voltinism. Philosophical Transactions of the Royal Society B: Biological Sciences. 374(1778). DOI:10.1098/rstb.2018.0547\rKearney MR, Deutscher J, Kong JD, Hoffmann AA. (2018) Summer egg diapause in a matchstick grasshopper synchronises the life cycle and buffers thermal extremes. Integrative Zoology. 13(4): 437–449. DOI: 10.1111/1749-4877.12314\rMaino JL, Kong JD, Hoffmann AA, Barton MG, Kearney MR. (2016) Mechanistic models for predicting insect responses to climate change. Current Opinion in Insect Science. 17: 81 – 86. DOI: 10.1016/j.cois.2016.07.006\rKong JD, Axford JK, Hoffmann AA, Kearney MR. (2016) Novel applications of thermocyclers for phenotyping invertebrate thermal responses. Methods in Ecology and Evolution. 7(10): 1201 – 1208. 2016. DOI: 10.1111/2041-210X.12589\r\r\rResearch highlights\rGoogle scholar\nH-index: 4 (GS)\nTotal citations: 39\n\r\rEcology/evolution studies in some of the best journals in their respective disciplines, including Methods in Ecology and Evolution and Philosophical Transactions of the Royal Society B\rMethods in Ecology and Evolution video explaining the use of thermocyclers as efficient incubators [see 1 above]\rInfluential paper on the use of mechanistic species distribution modelling for predicting ectotherm responses to climate change in Current Opinion in Insect Science [see 2 above]\r\r\rI have peer reviewed for:\n\rGlobal Change Biology\rEntomologia Experimentalis et Applicata\rMethods in Ecology and Evolution\rNature Ecology and Evolution\rEcological Entomology\rThe Canadian Entomologist\rEnvironmental Entomology\rJournal of Fish Biology\rCurrent Zoology\rScientific Reports\r\r\rResearch grants or awards\rTOTAL: $13 750 AUD 🇦🇺\n\r$2 500 AUD. 6.2018 Holsworth Wildlife Research Endowment\nEquity Trustees Charitable Foundation \u0026amp; the Ecological Society of Australia\n\r$300 AUD. 12.2018 2nd runner up student presentation\nAustralian and New Zealand Society for Comparative Physiology and Biochemistry, Australia\n\r$500 AUD. 8.2018 Student Travel Grant\nAustralian Entomological Society, Australia\r$1 500 AUD. 2018 Science Abroad Travelling Scholarship\nFaculty of Science, the University of Melbourne, Australia\r$950 AUD. 2018 FH Drummond Travel Award\nSchool of BioSciences, the University of Melbourne, Australia\n\r$1 500 AUD. 2018 School of BioSciences Travelling Scholarship\nSchool of BioSciences, the University of Melbourne, Australia\n\r$6 000 AUD. 6.2018 Holsworth Wildlife Research Endowment\nEquity Trustees Charitable Foundation\r$500 AUD. 6.2018 Three Minute Thesis (3MT) People’s Choice Winner\nThe University of Queensland Undergraduate Research Conference\r\rOther Awards and Scholarships\r\r$13 541 AUD. 2018 Research Training Program Scholarship, Australian Government\n\r$26 682 AUD. 2017 Research Training Program Scholarship, Australian Government\n\r$200 AUD. 2017 Runners-up in the Sustainability Prize photo competition, Graduate Student Association, the University of Melbourne\r$26 288 AUD. 2016 Australian Postgraduate Award, Australian Government\n\r$25 849 AUD. 2015 Australian Postgraduate Award, Australian Government\n\r2013 University Medal, the University of Queensland, Australia\n\r\r2010 – 2013 Dean’s Commendation for Academic Excellence (formerly Dean’s Commendation for High Achievement), the Faculty of Science, the University of Queensland, Australia\r\r\r\rTeaching contributions and course development\r2020\n\rLecturer \u0026amp; course development: Statistics and computation for biologists (BYU22SC01). 2nd year undergraduate. Trinity College Dublin. Developed course lectures and practical material, implemented reproducible workflow for online exams. Adapted for remote delivery. Module co-ordinator.\rLecturer \u0026amp; course development: Animal Diversity I (ZOU330003). 3nd year undergraduate. Trinity College Dublin. Developed course lectures and practical material. Module co-coordinator. Adapted for remote delivery.\rLecturer \u0026amp; course development: Animal Diversity II (ZOU330004). 3nd year undergraduate. Trinity College Dublin. Developed course lectures and practical material. Adapted for remote delivery.\r\r2019\n\rLecturer \u0026amp; course development: Statistics and computation for biologists (BYU22SC01). 2nd year undergraduate. Trinity College Dublin. Developed course lectures and practical material, implemented reproducible workflow for online exams.\rLecturer \u0026amp; course development: Animal Diversity I (ZOU330003). 3nd year undergraduate. Trinity College Dublin. Developed course lectures and practical material. Acting module co-coordinator.\rLecturer \u0026amp; course development: Animal Diversity II (ZOU330004). 3nd year undergraduate. Trinity College Dublin. Developed course lectures and practical material.\r\r2017\n\rGuest lecturer: 2rd year Comparative Animal Physiology, Uni Melbourne\rCourse development: 2nd year Biostatistics, Uni Melbourne. Evaluated course context and provided feedback.\r\r2016\n\rGuest lecturer: 2rd year Comparative Animal Physiology, Uni Melbourne\r\r\rConference presentations and invited talks\r2019\n\rDetangling the complex problem of climate adaptation of insects living in a seasonal world\rVictorian Biodiversity Conference, University of Melbourne, VIC, Australia\rLocal adaptation of thermal responses generates voltinism patterns of matchstick grasshoppers, Warramaba (Orthoptera: Morabidae), along a latitudinal gradient\rBritish Ecological Society Annual Meeting, Belfast, N. Ireland, UK\r\r2018\n\rSelection against overwintering shapes thermal performance curves for development\rAustralian and New Zealand Society for Comparative Physiology and Biochemistry Conference, Monash University, VIC, Australia\rEnvironmental and developmental drivers at the egg stage generate divergent life cycles in wingless arid zone grasshoppers (Orthoptera: Warramaba).\rAustralian Entomological Society Conference, Alice Springs, N.T., Australia\rThe egg stage drives life cycle adaptation to climate in the widely distributed matchstick grasshoppers (Vandiemenella and Warramaba, Orthoptera: Morabidae)\r‘The height, breadth and depth of physiological diversity: variation across latitudinal, altitudinal and depth gradients’ Animal Biology Satellite Meeting, Florence, Italy, Society for Experimental Biology\rMicroclimate-driven mechanistic models to examine clinal adaptation at the egg stage in a parthenogenetic grasshopper\rSociety for Experimental Biology Annual Conference, Florence, Italy\r\r2017\n\rDoes variation in egg developmental responses to temperature generate divergent life-cycles in a genus of flightless grasshoppers (Warramaba spp.)?\rSchool of BioSciences Postgraduate Symposium, the University of Melbourne, Parkville, Australia\rEgg development drives life cycles in Warramaba spp. grasshoppers\rAustralian and New Zealand Society for Comparative Physiology and Biochemistry Conference, Daintree Rainforest Observatory, QLD, Australia\rMechanistic models for understanding and predicting insect responses to climate change\rAustralian Entomological Society Conference, Terrigal, N.S.W., Australia\r\r2016\n\rPredicting insect egg development under variable climates\rSchool of BioSciences Postgraduate Symposium, the University of Melbourne, Parkville, Australia\rPredicting egg development in the parthenogenetic grasshopper Warramaba virgo (Orthoptera: Morabidae)\rAustralian and New Zealand Society for Comparative Physiology and Biochemistry Conference, Western Sydney University, N.S.W., Australia\r\r2015\n\rNovel applications of thermocyclers for high-throughput phenotyping of invertebrate thermal response\rAustralian and New Zealand Society for Comparative Physiology and Biochemistry Conference, Fowler’s Gap, N.S.W., Australia\r\r2013\n\rEvery Breath You Take Links Metabolism and Ecology\rThree Minute Thesis, Undergraduate Research Conference, the University of Queensland, Australia The University of Queensland\rEvery Breath You Take Links Metabolism and Ecology. Summer Research Introduction Session 2013, invited by the Office of Undergraduate Education, the University of Queensland, Australia\rFlying foxes and you: Exploring the exposure of society to so-called “rats with wings”\rBachelor of Science Welcome Day, invited by the Faculty of Science, the University of Queensland, Australia\r\r2012\n\rFlying foxes and you: Exploring the exposure of society to so-called “rats with wings”\rAdvanced Study Program in Science Student Conference, the University of Queensland, Australia\r\r2011\n\rFemale-biased dispersal in the Eastern Water Dragon (Physignathus lesueurii lesueurii)\rAdvanced Study Program in Science Student Conference, the University of Queensland, Australia\r\r\rProfessional service and affiliations\r\r2015 – Present Member: Australian and New Zealand Society for Comparative Physiology and Biochemistry\r2019 – Present Member: British Ecological Society \u0026amp; Irish Ecological Society\r2018 Member: Royal Society of Victoria\r2017 – Present Member: Society for Experimental Biology\r2015 – 2020 Member: Australian Entomological Society\r2017 – 2018 President, BioSciences Postgraduate Society, the University of Melbourne\r2016 – 2017 Vice President, BioSciences Postgraduate Society, the University of Melbourne\r\r\rCommunity outreach and communication\r\r2020 Guest interview with Newstalk radio, Ireland\r2019 Home and Away: Would a Rosella by any other name smell as sweet (online 1 Nov).\nHome and Away: Monotreme mistakes (online 22 Nov).\nHome and Away: Australian expats (online 12 Dec).\n3 part blog series for EcoEvo@TCD http://www.ecoevoblog.com\r2018 Big Ideas in Macrophysiology. Report on the 2018 Animal Biology Satellite Meeting, Florence Italy. Society for Experimental Biology Magazine https://www.sebiology.org/digital-magazine/autumn-2018/#p=18\r2016, 2017 Session Chair, BioSciences Postgrad Symposium, the University of Melbourne, Australia\r2017/19 Victorian Biodiversity Conference Volunteer, Melbourne, Australia\r2015/17/18 The University of Melbourne Open Day Volunteer, the University of Melbourne, Melbourne, Australia\r2017 Blog post for Graduate Student Association, University of Melbourne on the biodiversity photo competition\r2016 Novel applications of thermocyclers for characterising invertebrate thermal responses. Video for Methods in Ecology and Evolution. https://youtu.be/uXzEfvR_hoE\r2015 The Real Life of a Research Student. Science Undergraduate Research Journal (SURJ), Issue 2. The University of Queensland, Australia\r2015 Jacinta on Zoology \u0026amp; Research. Interview with BITE BACK, Black Dog Institute, Australia. 31st August 2015\r2014 Brisbane Open House Volunteer, Brisbane Open House, Brisbane, Australia\rStudent Chaperone for the International Baccalaureate World Student Conference, the University of Queensland, Australia\r2012/14 Moreton Bay Research Station Open Day Assistant, Moreton Bay Research Station, Brisbane, Australia\r2013 Science Mentor to Science Undergraduate Students, appointed by the Faculty of Science, the University of Queensland, Australia\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607972437,"objectID":"9780949a3024bbdfdb7ce88dfaa4afe3","permalink":"https://jacintak.github.io/CV/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/CV/","section":"","summary":"Research and teaching appointments\rQualifications\rRefereed journal articles\rResearch highlights\rResearch grants or awards\r\rOther Awards and Scholarships\r\rTeaching contributions and course development\rConference presentations and invited talks\rProfessional service and affiliations\rCommunity outreach and communication\r\r\rResearch and teaching appointments\r\rTeaching and Research Fellow\nDepartment of Zoology, School of Natural Sciences.\nTrinity College Dublin, Dublin, Ireland\n5.2019 – Present\rResearch Assistant","tags":null,"title":"CV -  Jacinta D Kong","type":"page"},{"authors":null,"categories":null,"content":"Move. Adapt. Die. Ectotherms have adapted their entire life cycle to the rhythm of the seasons. The egg stage is a critical part of insect life cycles that must resist or tolerate environmental fluctuations. How immobile eggs do so and how these mechanisms change in their function or importance over geographical gradients is a complex story.\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"a5ba6bdabb26526efa479d81b00aa22e","permalink":"https://jacintak.github.io/project/life-cycles/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/project/life-cycles/","section":"project","summary":"How are ectotherm life cycles adapted to seasonal climate cycles?","tags":["ectotherms","life cycles"],"title":"Predicting ectotherm life cycles","type":"project"},{"authors":null,"categories":null,"content":"Temperature affects biological processes on many levels of biological organisation. I am determining how the relationship between rates and temperatures affects processes beyond the individual and on macro scales.\nThis is an SFI funded position with Nicholas Payne\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1607952483,"objectID":"4833c7bc854c275d509d55a420575619","permalink":"https://jacintak.github.io/project/temperature-dependence/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/project/temperature-dependence/","section":"project","summary":"Temperature affects biological processes on many levels of biological organisation","tags":["ectotherms","thermal adaptation"],"title":"Thermal dependence of biological rates","type":"project"}]